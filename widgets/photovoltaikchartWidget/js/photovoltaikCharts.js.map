{"version":3,"sources":["days.js","data.js"],"names":["months","en","de","ru","es","fr","it","pl","pt","nl","days","readOneChart","seriesData","id","instance","currentId","multiplicator","index","callback","mode","startdate","seriesCount","eventDate","option","currentYear","Date","getFullYear","startYear","numberOfYears","start","end","getTime","aggregate","count","timeout","console","log","vis","getHistory","err","res","Object","keys","length","error","JSON","stringify","i","ts","data","getMonth","val","states","_readData","oidList","j","historyOID","currentOID","setTimeout","loadSelectorData","duration","startDate","setMonth","conn","sendTo","result","dbid","rowcount","sql","normalizeDate","push","readOneLineRange","chart","virtualStart","virtualEnd","lastEventDate","series","setData","readAndAddOneLineRange","newMax","addPoint","loadSeriesRange","loadAndAddSeriesRange","date","setMilliseconds","setSeconds","setMinutes","setUTCMilliseconds","setUTCSeconds","setUTCMinutes","setUTCHours","day","getDay","diff","getDate","setDate","setUTCDate","setUTCMonth","minDate","H","Chart","prototype","pan","e","panning","panningOptions","doRedraw","type","this","hoverPoints","chartOptions","options","enabled","fireEvent","originalEvent","forEach","point","setState","xy","isX","spill","axis","axisOpt","horiz","mousePos","mouseDown","startPos","halfPointRange","pointRange","pointRangeDirection","reversed","inverted","extremes","getExtremes","panMin","toValue","panMax","len","flipped","newMin","paddedMin","paddedMax","ordinal","min","max","panningState","startMin","startMax","setExtremes","trigger","redraw","css","container","cursor","zoom","event","hasZoomed","pointer","mouseDownPos","mouseDownX","mouseDownY","displayButton","resetSelection","axes","initiated","xAxis","concat","yAxis","axisData","axisStartPos","left","top","axisEndPos","width","height","isXAxis","isWithinPane","defined","displayBtn","resetZoomButton","showResetZoom","isObject","destroy","pick","animation","pointCount","Axis","maxX","minX","navigator","dataMin","dataMax","Math","evt","allowZoomOutside","zoomed","Pointer","pinch","self","pinchDown","touches","touchesLength","lastValidTouch","hasZoom","transform","fireClickEvent","inClass","target","runTrackerClick","runChartClick","clip","selectionMarker","followTouchMove","cancelable","preventDefault","map","call","normalize","chartX","chartY","x","y","zoomEnabled","bounds","minPixelPadding","toPixels","absMin","absMax","pos","runPointActions","extend","noop","touch","plotBox","pinchTranslate","hasPinched","scaleGroups","reset","Highcharts","types","handler","orgEvent","window","args","slice","arguments","delta","deltaX","deltaY","$","fix","wheelDelta","detail","undefined","HORIZONTAL_AXIS","wheelDeltaY","wheelDeltaX","unshift","handle","apply","special","mousewheel","setup","addEventListener","onmousewheel","teardown","removeEventListener","fn","bind","unmousewheel","unbind","binds","photovoltaikcharts","version","updateIntervalHandler","reloadIntervalHandler","delayedRefreshHandler","playHandler","showVersion","highchartsOptions","lang","weekdays","shortWeekdays","shortMonths","contextButtonTitle","decimalPoint","downloadCSV","downloadJPEG","downloadPDF","downloadPNG","downloadSVG","downloadXLS","exitFullscreen","hideData","loading","noData","numericSymbols","printChart","resetZoom","resetZoomTitle","viewData","viewFullscreen","exportData","annotationHeader","categoryDatetimeHeader","categoryHeader","highchartsSeriesUnits","highchartsDateTimeLabelFormats","millisecond","second","minute","hour","week","month","year","scrollspeed","getUniqueOID","item","indexOf","findOID","iod","createMonthlyWidget","widgetID","view","style","targetArray","fbobj","$div","systemLang","sysLang","split","k","parseFloat","lastX","today","targetData","categories","toString","name","substr","stack","color","lineWidth","fillOpacity","opacity","Array","isArray","targetName","step","marker","onChangeSeries","newVal","oldVal","ids","update","language","setOptions","unit","zoomType","options3d","alpha","beta","depth","viewDistance","frame","bottom","size","title","text","zAxis","labels","rotation","plotOptions","column","stacking","groupZPadding","groupPadding","grouping","legend","showLegend","exporting","showMenu","tooltip","formatter","stackTotal","userOptions","stacklabel","credits","uniqueOID","createYearlyWidget","defaultData","plotLines","dashStyle","label","value","createTimeseriesWidget","divId","loadRunning","refreshRequired","lastEvent","navigationData","boostThreshold","parseInt","dataGrouping","approximation","units","hover","pointInterval","loadSeriesData","showLoading","hideLoading","clearInterval","setInterval","points","oldExtremes","oldLastX","newMaxX","stockChart","renderTo","panKey","time","timezoneOffset","getTimezoneOffset","rangeSelector","buttons","allButtonsEnabled","dropdown","selected","1d","3d","7d","1m","3m","6m","ytd","1y","all","zoomDefault","inputDateFormat","adaptToUpdatedData","margin","lineColor","navcolor","scrollbar","events","afterSetExtremes","dateTimeLabelFormats","overscroll","align","chart1Height","resize","yAxis1min","yAxis1max","tickAmount","yAxis1tickamount","minorTicks","chartspacing","chart2Height","offset","yAxis2min","yAxis2max","yAxis2tickamount","verticalAlign","floating","itemStyle","legendItemStyle","parse","fontSize","fontWeight","textOverflow","itemDistance","legendItemDistance","pointFormat","valueDecimals","navigatorRange","zoomRatio","objEvent","intDelta","setZoom","xMin","xMax","createTimeseries2Widget","navhistoryoid","navinstance","navmultiplicator","unit1","xAxisLabel1","yAxis1Categories","startOnTick","updateSeriesData","oldLastMaxX","eventValue","limit","chart2enabled","unit2","xAxisLabel2","yAxis2Categories","chart3enabled","unit3","xAxisLabel3","yAxis3Categories","chart3Height","yAxis3min","yAxis3max","yAxis3tickamount","useUTC","autoreload","reloadSeriesData","createTimeseries3Widget","serieshistoryoid1","onChangeZoom","zoomoid","currentExtremes","backgroundColor","click","storeTimestampSelected","removePlotLine","setValue","hoverPoint","addPlotLine","crosshair","showCrosshairX","showCrosshairY","visible","showYAxis","setSize","stepForward","findSelected","playstep","playid","playspeed","onStepForward","stepforwardid","onStepBackward","stepbackid","onPlay","plotLinesAndBands","editMode","createPhotovoltaikModuleWidget","cache","historyLoading","getValue","now","obj","cacheDate","getColor","energyValue","vgValue","modulePower","svg","find","onChangeValue","toLocaleString","minimumFractionDigits","attr","serieshistoryoid","serieslabel","timestampid","createGaugeWidget","gaugeOptions","pane","center","panCenterX","panCenterY","startAngle","startAngel","endAngle","stopAngel","background","linearGradient","x1","y1","x2","y2","stops","paneBackgroundColor1","paneBackgroundColor2","borderColor","innerRadius","outerRadius","shape","tickWidth","minorTickInterval","titlePositionY","labelsPositionY","solidgauge","dataLabels","dataLabelsPositionY","borderWidth","dataLabelsBorderWidth","useHTML","oid","format","fontsizevalue","valuesuffix","fontsizesuffix","valueSuffix","stopCount","stop"],"mappings":"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","file":"photovoltaikCharts.js","sourcesContent":["var months = {\n    'en': ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    'de': ['Jan', 'Feb', 'Mär', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Okt', 'Nov', 'Dez'],\n    'ru': ['Янв', 'Фев', 'Мар', 'Апр', 'Май', 'Июн', 'Июл', 'Авг', 'Сен', 'Окт', 'Ноя', 'Дек'],\n    'es': ['Jan', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'],\n    'fr': ['Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    'it': ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    'pl': ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],\n    'pt': ['Jan', 'Feb', 'Mar', 'Apr', 'Mai', 'Jun', 'Jul', 'Aug', 'Set', 'Out', 'Nov', 'Dez'],\n    'nl': ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']\n};\nvar days = {\n    'en': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    'de': ['So', 'Mo', 'Di', 'Mi', 'Do', 'Fr', 'Sa'],\n    'ru': ['Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб', 'Вс'],\n    'es': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    'fr': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    'it': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    'pl': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    'pt': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'],\n    'nl': ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat']\n};","'use strict';\r\n\r\nfunction readOneChart(seriesData,id,instance,currentId,multiplicator, index, callback,mode,startdate,seriesCount) {\r\n\r\n    var option = {};\r\n\tvar eventDate;\r\n\tvar currentYear=new Date ().getFullYear();\r\n\tvar startYear=new Date (startdate).getFullYear();\r\n\t\r\n\tvar numberOfYears=currentYear - startYear + 1;\r\n\toption.start=startdate;\r\n\toption.end=(new Date(currentYear, 11, 31,23,59)).getTime();\r\n    option.instance  = instance;\r\n\toption.aggregate='none';\r\n\toption.count=1000;\r\n\toption.timeout=6000;\r\n    console.log(new Date(option.start) + ' - ' + new Date(option.end));\r\n\tvis.getHistory(id, option, function (err, res) {\r\n\t\tconsole.log('got History data');\r\n        if (err && Object.keys(err).length > 0) console.error('Error Object: ' + JSON.stringify(err));\r\n\r\n\r\n        if (!err && res) {\r\n            for (var i = 0; i < res.length; i++) {\r\n\t\t\t\teventDate=new Date (res[i].ts);\r\n\t\t\t\tif (mode===1){\r\n\t\t\t\t\tseriesData[(eventDate.getFullYear()-startYear)*(seriesCount) + index].data[eventDate.getMonth()]=(res[i].val || 0) * multiplicator;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tseriesData[index].data[numberOfYears-1 - currentYear + eventDate.getFullYear()]=(res[i].val || 0) *multiplicator;\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t} \t\r\n            // free memory\r\n            res = null;\r\n        }\r\n\r\n        if (currentId) {\r\n\t\t\tif (mode===1){\r\n\t\t\t\tseriesData[(currentYear-startYear)*(seriesCount) + index].data[(new Date ()).getMonth()]=(vis.states[currentId + '.val'] || 0) * multiplicator;\r\n\t\t\t} else {\r\n\t\t\t\tseriesData[index].data[numberOfYears-1]=(vis.states[currentId + '.val']|| 0) * multiplicator;\r\n\t\t\t}\t\t\r\n\t\t};\r\n  \t    if (callback) callback();\r\n    });\r\n}\r\n\r\n\r\nfunction _readData(seriesData,oidList,callback, j,mode,startdate) {\r\n    j = j || 0;\r\n    if (j >= oidList.length) {\r\n        return callback && callback();\r\n    } else {\r\n\t\tif (oidList[j].historyOID && oidList[j].instance) {\r\n\t\t\treadOneChart(seriesData,oidList[j].historyOID,oidList[j].instance,oidList[j].currentOID,oidList[j].multiplicator,j, function () {\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\t_readData(seriesData,oidList,callback, j + 1,mode,startdate);\r\n\t\t\t\t}, 10);\r\n\t\t\t},mode,startdate,oidList.length);\r\n\t\t}else{\r\n            setTimeout(function () {\r\n                _readData(seriesData,oidList,callback, j + 1,mode,startdate);\r\n            }, 10);\t\t\t\r\n\t\t}\r\n    }\r\n}\r\n\r\n\r\nfunction loadSelectorData(data,id,instance,currentId,multiplicator,mode,duration,callback) {\r\n\tvar startDate=new Date ();\r\n\tstartDate.setMonth (-1 * duration);\r\n\tvar start=startDate.getTime();\r\n    if (id && instance){\r\n\t\tvis.conn.sendTo(instance, 'query', \r\n\t\t\t\"select id from iobroker.datapoints where name ='\" + id + \"'\"\r\n\t\t, function (result) {\r\n\t\t\tif (result.error) {\r\n\t\t\t\tconsole.error(result.error);\t\t\t\r\n\t\t\t\tif (callback) callback();\r\n\t\t\t} else {\r\n\t\t\t\t// show result\r\n\t\t\t\tconsole.log('Rows: ' + JSON.stringify(result.result));\r\n\t\t\t\tif (result.result[0] && result.result[0].id){\r\n\t\t\t\t\tvar dbid=result.result[0].id;\r\n\t\t\t\t\tvis.conn.sendTo(instance, 'query', \r\n\t\t\t\t\t\t\"select COUNT(ts) AS rowcount from iobroker.ts_number where id=\" + dbid + \" and ts>\" + start\r\n\t\t\t\t\t, function (result) {\r\n\t\t\t\t\t\tif (result.error) {\r\n\t\t\t\t\t\t\tconsole.error(result.error);\t\t\t\r\n\t\t\t\t\t\t\tif (callback) callback();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// show result\r\n\t\t\t\t\t\t\tconsole.log('Rows: ' + JSON.stringify(result.result));\r\n\t\t\t\t\t\t\tif (result.result[0] && result.result[0].rowcount){\r\n\t\t\t\t\t\t\t\tvar rowcount=result.result[0].rowcount;\r\n\t\t\t\t\t\t\t\tif (rowcount<1000) {\r\n\t\t\t\t\t\t\t\t\tvar sql = \"SELECT ts,val FROM iobroker.ts_number where id=\" + dbid;\r\n\t\t\t\t\t\t\t\t} else if (rowcount<10000) {\r\n\t\t\t\t\t\t\t\t\tvar sql = \"SELECT * FROM ( SELECT @row := @row +1 AS rownum, ts,val FROM (SELECT @row :=0) r, iobroker.ts_number where id=\" + dbid +\" and ts>\" + start +\") ranked WHERE rownum % (\" + rowcount + \" DIV 200) = 1\";\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else if (rowcount<50000) {\r\n\t\t\t\t\t\t\t\t\tvar sql = \"SELECT * FROM ( SELECT @row := @row +1 AS rownum, ts,val FROM (SELECT @row :=0) r, iobroker.ts_number where id=\" + dbid +\" and ts>\" + start +\") ranked WHERE rownum % (\" + rowcount + \" DIV 300) = 1\";\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else if (rowcount<80000) {\r\n\t\t\t\t\t\t\t\t\tvar sql = \"SELECT * FROM ( SELECT @row := @row +1 AS rownum, ts,val FROM (SELECT @row :=0) r, iobroker.ts_number where id=\" + dbid +\" and ts>\" + start +\") ranked WHERE rownum % (\" + rowcount + \" DIV 500) = 1\";\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tvar sql = \"SELECT * FROM ( SELECT @row := @row +1 AS rownum, ts,val FROM (SELECT @row :=0) r, iobroker.ts_number where id=\" + dbid +\" and ts>\" + start +\") ranked WHERE rownum % (\" + rowcount + \" DIV 1000) = 1\";\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvis.conn.sendTo(instance, 'query', sql\r\n\t\t\t\t\t\t\t\t, function (result) {\r\n\t\t\t\t\t\t\t\t\tif (result.error) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.error(result.error);\t\t\t\r\n\t\t\t\t\t\t\t\t\t\tif (callback) callback();\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t// show result\r\n\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < result.result.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\teventDate=normalizeDate(new Date (result.result[i].ts),mode);\r\n\t\t\t\t\t\t\t\t\t\t\t//console.log(eventDate + ':' + result.result[i].val);\r\n\t\t\t\t\t\t\t\t\t\t\tdata.push ([eventDate.getTime(),(result.result[i].val || 0) * multiplicator]);\r\n\t\t\t\t\t\t\t\t\t\t} \t\r\n\t\t\t\t\t\t\t\t\t\t// free memory\r\n\t\t\t\t\t\t\t\t\t\tres = null;\t\t\r\n\t\t\t\t\t\t\t\t\t\tif (currentId) {\r\n\t\t\t\t\t\t\t\t\t\t\tdata.push ([normalizeDate(new Date (),mode).getTime(),(vis.states[currentId + '.val'] || 0) * multiplicator]);\r\n\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\tif (callback) callback();\r\n\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t});\t\t\t\t\t\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tif (callback) callback();\r\n\t\t\t\t\t\t\t}\t\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t});\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (callback) callback();\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\tif (callback) callback();\r\n\t}\r\n}\r\n\r\n\r\nfunction readOneLineRange(chart,id,instance,currentId,multiplicator, index,mode,start,end,virtualStart,virtualEnd,callback) {\r\n\r\n    var option = {};\r\n\tvar eventDate;\r\n\tvar lastEventDate=new Date (0);\t\r\n\tvar currentYear=new Date ().getFullYear();\r\n\tvar data = [];\r\n\tif (virtualStart<start) data.push([virtualStart,0]);\r\n\toption.start=start;\r\n\toption.end=end;\r\n    option.instance  = instance;\r\n\toption.aggregate='minmax';\r\n\t//option.count=2000;\r\n\toption.timeout=6000;\r\n    console.log(JSON.stringify(option));\r\n    console.log('Load Range for ' + id +' '+ new Date(option.start) + ' - ' + new Date(option.end));\r\n\tvis.getHistory(id, option, function (err, res) {\r\n        if (err && Object.keys(err).length > 0) console.error('Error Object: ' + JSON.stringify(err));\r\n        if (!err && res) {\r\n\t\t\tconsole.log('got History data. Count:' + res.length);\t\t\r\n            for (var i = 0; i < res.length; i++) {\r\n\t\t\t\teventDate=normalizeDate(new Date (res[i].ts),mode);\r\n\t\t\t\t//console.log(id +' '+ new Date (res[i].ts)+ ' n ' + eventDate + ':' + res[i].val);\r\n\t\t\t\tif (res[i].val!=null){\r\n\t\t\t\t\tif (lastEventDate.getTime()==eventDate.getTime()) {\r\n\t\t\t\t\t\t//console.log('replace ' + new Date (data[data.length-1][0]) + ':' + res[i].val);\t\t\t\t\t\r\n\t\t\t\t\t\tdata[data.length-1][1]=(res[i].val || 0) * multiplicator;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdata.push ([eventDate.getTime(),(res[i].val || 0) * multiplicator]);\r\n\t\t\t\t\t\tlastEventDate=eventDate;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} \t\r\n            // free memory\r\n            res = null;\r\n        }\r\n\r\n        if (currentId) {\r\n\t\t\tconsole.log ('Add current value for ' + currentId + ': date ' + normalizeDate(new Date (),mode).getTime() + 'value ' + vis.states[currentId + '.val']);\r\n\t\t\tif (data.length>0 && data[data.length-1][0]== normalizeDate(new Date (),mode).getTime()){\r\n\t\t\t\tdata[data.length-1][1]=(vis.states[currentId + '.val']|| 0) * multiplicator;\r\n\t\t\t} else {\r\n\t\t\t\tdata.push ([normalizeDate(new Date (),mode).getTime(),(vis.states[currentId + '.val']|| 0) * multiplicator]);\r\n\t\t\t}\r\n\t\t};\r\n\t\tif (virtualEnd>end) data.push([virtualEnd,0]);\r\n\t\tchart.series[index].setData (data,false);\r\n  \t    if (callback) callback();\r\n    });\r\n}\r\n\r\nfunction readAndAddOneLineRange(chart,id,instance,multiplicator, index,mode,start,end,newMax,callback) {\r\n\r\n    var option = {};\r\n\tvar eventDate;\r\n\tvar lastEventDate=new Date (0);\t\r\n\tvar currentYear=new Date ().getFullYear();\r\n\tvar data = [];\r\n\toption.start=start;\r\n\toption.end=end;\r\n    option.instance  = instance;\r\n\toption.aggregate='minmax';\r\n\toption.timeout=6000;\r\n    console.log('Load Range for ' + id +' '+ new Date(option.start) + ' - ' + new Date(option.end));\r\n\tvis.getHistory(id, option, function (err, res) {\r\n        if (err && Object.keys(err).length > 0) console.error('Error Object: ' + JSON.stringify(err));\r\n        if (!err && res) {\r\n\t\t\tconsole.log('got History data. Count:' + res.length);\t\t\r\n            for (var i = 0; i < res.length; i++) {\r\n\t\t\t\teventDate=normalizeDate(new Date (res[i].ts),mode);\r\n\t\t\t\tif (res[i].val!=null){\r\n\t\t\t\t\tif (lastEventDate.getTime()==eventDate.getTime()) {\r\n\t\t\t\t\t\tdata[data.length-1][1]=(res[i].val || 0) * multiplicator;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdata.push ([eventDate.getTime(),(res[i].val || 0) * multiplicator]);\r\n\t\t\t\t\t\tlastEventDate=eventDate;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} \t\r\n            // free memory\r\n            res = null;\r\n\t\t\tif (data.length>0 && newMax< data[data.length-1][0])newMax=data[data.length-1][0];\r\n\t\t\tfor (var i=0;i<data.length;i++){\r\n\t\t\t\t//console.log(' add point to ' + id + ':' + JSON.stringify(data[i]));\t\r\n\t\t\t\tchart.series[index].addPoint (data[i],false,false,false,false); \t\t\t\t\r\n\t\t\t};\t\t\t\t\r\n        }\r\n  \t    if (callback) callback(newMax);\r\n    });\r\n}\r\n\r\n\r\nfunction loadSeriesRange(chart,oidList, j,mode,start, end,virtualStart,virtualEnd, callback) {\r\n    j = j || 0;\r\n    if (j >= oidList.length) {\r\n        return callback && callback();\r\n    } else {\r\n\t\tif (oidList[j].historyOID && oidList[j].instance) {\r\n\t\t\treadOneLineRange(chart,oidList[j].historyOID,oidList[j].instance,oidList[j].currentOID,oidList[j].multiplicator,j,mode,start,end,virtualStart,virtualEnd, function () {\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tloadSeriesRange(chart,oidList, j+1,mode,start, end,virtualStart,virtualEnd, callback);\r\n\t\t\t\t}, 10);\r\n\t\t\t});\r\n\t\t}else{\r\n            setTimeout(function () {\r\n\t\t\t\t\tloadSeriesRange(chart,oidList, j+1,mode,start, end,virtualStart,virtualEnd, callback);\r\n            }, 10);\t\t\t\r\n\t\t}\r\n    }\r\n}\r\n\r\n\r\nfunction loadAndAddSeriesRange(chart,oidList, j,mode,start, end, newMax, callback) {\r\n    j = j || 0;\r\n    if (j >= oidList.length) {\r\n        return callback && callback(newMax);\r\n    } else {\r\n\t\tif (oidList[j].historyOID && oidList[j].instance) {\r\n\t\t\treadAndAddOneLineRange(chart,oidList[j].historyOID,oidList[j].instance,oidList[j].multiplicator,j,mode,start,end,newMax, function (newMax) {\r\n\t\t\t\tsetTimeout(function () {\r\n\t\t\t\t\tloadAndAddSeriesRange(chart,oidList, j+1,mode,start, end,newMax, callback);\r\n\t\t\t\t}, 10);\r\n\t\t\t});\r\n\t\t}else{\r\n            setTimeout(function () {\r\n\t\t\t\t\tloadAndAddSeriesRange(chart,oidList, j+1,mode,start, end,newMax, callback);\r\n            }, 10);\t\t\t\r\n\t\t}\r\n    }\r\n}\r\n\r\nfunction normalizeDate (date,mode) {\r\n\tif (mode=='hour') {\r\n\t\tdate.setMilliseconds(0);\r\n\t\tdate.setSeconds(0);\t\r\n\t\tdate.setMinutes(0);\r\n\t} else if (mode=='day') {\r\n\t\tdate.setUTCMilliseconds(0);\r\n\t\tdate.setUTCSeconds(0);\t\r\n\t\tdate.setUTCMinutes(0);\r\n\t\tdate.setUTCHours(0);\t\t\r\n\t} else if (mode=='week') {\r\n\t\tvar day = date.getDay();\r\n\t\tvar diff = date.getDate() - day + (day == 0 ? -6:1);\r\n\t\tdate=new Date(date.setDate(diff));\r\n\t\tdate.setUTCMilliseconds(0);\r\n\t\tdate.setUTCSeconds(0);\t\r\n\t\tdate.setUTCMinutes(0);\r\n\t\tdate.setUTCHours(0);\t\t\t\t\r\n\t\treturn date;\r\n\t} else if (mode=='month') {\r\n\t\tdate.setUTCMilliseconds(0);\r\n\t\tdate.setUTCSeconds(0);\t\r\n\t\tdate.setUTCMinutes(0);\r\n\t\tdate.setUTCHours(0);\t\t\r\n\t\tdate.setUTCDate(1);\r\n\t} else if (mode=='year') {\r\n\t\tdate.setUTCMilliseconds(0);\r\n\t\tdate.setUTCSeconds(0);\t\r\n\t\tdate.setUTCMinutes(0);\r\n\t\tdate.setUTCHours(0);\t\t\r\n\t\tdate.setUTCDate(1);\r\n\t\tdate.setUTCMonth(0);\r\n\t};\r\n\treturn date;\r\n}\r\n\r\n\r\n\r\n\t\r\n\t\r\n\t\r\n \tvar minDate=new Date (2020,0,1).getTime();\r\n(function(H) {\r\n    H.Chart.prototype.pan = function(e, panning) {\r\n        var chart = this,\r\n            hoverPoints = chart.hoverPoints,\r\n            panningOptions, chartOptions = chart.options.chart,\r\n            doRedraw, type;\r\n        if (typeof panning === 'object') {\r\n            panningOptions = panning;\r\n        } else {\r\n            panningOptions = {\r\n                enabled: panning,\r\n                type: 'x'\r\n            };\r\n        }\r\n        if (chartOptions && chartOptions.panning) {\r\n            chartOptions.panning = panningOptions;\r\n        }\r\n        type = panningOptions.type;\r\n        H.fireEvent(this, 'pan', {\r\n            originalEvent: e\r\n        }, function() {\r\n            // remove active points for shared tooltip\r\n            if (hoverPoints) {\r\n                hoverPoints.forEach(function(point) {\r\n                    point.setState();\r\n                });\r\n            }\r\n            // panning axis mapping\r\n            var xy = [1]; // x\r\n            if (type === 'xy') {\r\n                xy = [1, 0];\r\n            } else if (type === 'y') {\r\n                xy = [0];\r\n            }\r\n            xy.forEach(function(isX) {\r\n                var axis = chart[isX ? 'xAxis' : 'yAxis'][0],\r\n                    axisOpt = axis.options,\r\n                    horiz = axis.horiz,\r\n                    mousePos = e[horiz ? 'chartX' : 'chartY'],\r\n                    mouseDown = horiz ? 'mouseDownX' : 'mouseDownY',\r\n                    startPos = chart[mouseDown],\r\n                    halfPointRange = (axis.pointRange || 0) / 2,\r\n                    pointRangeDirection = (axis.reversed && !chart.inverted) ||\r\n                    (!axis.reversed && chart.inverted) ?\r\n                    -1 :\r\n                    1,\r\n                    extremes = axis.getExtremes(),\r\n                    panMin = axis.toValue(startPos - mousePos, true) +\r\n                    halfPointRange * pointRangeDirection,\r\n                    panMax = axis.toValue(startPos + axis.len - mousePos, true) -\r\n                    halfPointRange * pointRangeDirection,\r\n                    flipped = panMax < panMin,\r\n                    newMin = flipped ? panMax : panMin,\r\n                    newMax = flipped ? panMin : panMax,\r\n                    \r\n                    // CHANGE\r\n                    \r\n                    paddedMin = minDate,\r\n                    paddedMax = new Date().getTime(),\r\n                            \r\n                    // CHANGE\r\n                            \r\n                    spill;\r\n\r\n                // It is not necessary to calculate extremes on ordinal axis,\r\n                // because the are already calculated, so we don't want to\r\n                // override them.\r\n                if (!axisOpt.ordinal) {\r\n                    // If the new range spills over, either to the min or max,\r\n                    // adjust the new range.\r\n                    if (isX) {\r\n                        spill = paddedMin - newMin;\r\n                        if (spill > 0) {\r\n                            newMax += spill;\r\n                            newMin = paddedMin;\r\n                        }\r\n                        spill = newMax - paddedMax;\r\n                        if (spill > 0) {\r\n                            newMax = paddedMax;\r\n                            newMin -= spill;\r\n                        }\r\n                    }\r\n                    // Set new extremes if they are actually new\r\n                    if (axis.series.length &&\r\n                        newMin !== extremes.min &&\r\n                        newMax !== extremes.max &&\r\n                        isX ? true : (axis.panningState &&\r\n                            newMin >= axis.panningState\r\n                            .startMin &&\r\n                            newMax <= axis.panningState\r\n                            .startMax //\r\n                        )) {\r\n                        axis.setExtremes(newMin, newMax, false, false, {\r\n                            trigger: 'pan'\r\n                        });\r\n                        doRedraw = true;\r\n                    }\r\n                    // set new reference for next run:\r\n                    chart[mouseDown] = mousePos;\r\n                }\r\n            });\r\n            if (doRedraw) {\r\n                chart.redraw(false);\r\n            }\r\n            H.css(chart.container, {\r\n                cursor: 'move'\r\n            });\r\n        });\r\n\t\t\t\t\r\n    };\r\n\t\r\n\t/**\r\n\t * Zoom into a given portion of the chart given by axis coordinates.\r\n\t *\r\n\t * @private\r\n\t * @function Highcharts.Chart#zoom\r\n\t * @param {Highcharts.SelectEventObject} event\r\n\t */\r\n\tH.Chart.prototype.zoom = function (event) {\r\n\t\tconsole.log (\"Chart Zoom handler \");\r\n\t\tvar chart = this,\r\n\t\t\tpointer = chart.pointer,\r\n\t\t\tmouseDownPos = chart.inverted ?\r\n\t\t\t\tpointer.mouseDownX : pointer.mouseDownY;\r\n\t\tvar displayButton = false,\r\n\t\t\thasZoomed;\r\n\t\t// If zoom is called with no arguments, reset the axes\r\n\t\tif (!event || event.resetSelection) {\r\n\t\t\tchart.axes.forEach(function (axis) {\r\n\t\t\t\thasZoomed = axis.zoom();\r\n\t\t\t});\r\n\t\t\tpointer.initiated = false; // #6804\r\n\t\t}\r\n\t\telse { // else, zoom in on all axes\r\n\t\t\tevent.xAxis.concat(event.yAxis).forEach(function (axisData) {\r\n\t\t\t\tvar axis = axisData.axis,\r\n\t\t\t\t\taxisStartPos = chart.inverted ? axis.left : axis.top,\r\n\t\t\t\t\taxisEndPos = chart.inverted ?\r\n\t\t\t\t\t\taxisStartPos + axis.width : axisStartPos + axis.height,\r\n\t\t\t\t\tisXAxis = axis.isXAxis;\r\n\t\t\t\tvar isWithinPane = false;\r\n\t\t\t\t// Check if zoomed area is within the pane (#1289).\r\n\t\t\t\t// In case of multiple panes only one pane should be zoomed.\r\n\t\t\t\tif ((!isXAxis &&\r\n\t\t\t\t\tmouseDownPos >= axisStartPos &&\r\n\t\t\t\t\tmouseDownPos <= axisEndPos) ||\r\n\t\t\t\t\tisXAxis ||\r\n\t\t\t\t\t!H.defined(mouseDownPos)) {\r\n\t\t\t\t\tisWithinPane = true;\r\n\t\t\t\t}\r\n\t\t\t\t// don't zoom more than minRange\r\n\t\t\t\tif (pointer[isXAxis ? 'zoomX' : 'zoomY'] && isWithinPane) {\r\n\t\t\t\t\thasZoomed = axis.zoom(axisData.min, axisData.max);\r\n\t\t\t\t\tif (axis.displayBtn) {\r\n\t\t\t\t\t\tdisplayButton = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t// Show or hide the Reset zoom button\r\n\t\tvar resetZoomButton = chart.resetZoomButton;\r\n\t\tif (displayButton && !resetZoomButton) {\r\n\t\t\tchart.showResetZoom();\r\n\t\t}\r\n\t\telse if (!displayButton && H.isObject(resetZoomButton)) {\r\n\t\t\tchart.resetZoomButton = resetZoomButton.destroy();\r\n\t\t}\r\n\t\t// Redraw\r\n\t\tif (hasZoomed) {\r\n\t\t\tchart.redraw(H.pick(chart.options.chart.animation, event && event.animation, chart.pointCount < 100));\r\n\t\t}\r\n\t};\r\n\t\t\r\n\t\t\r\n\tH.Axis.prototype.zoom = function (newMin, newMax) {\r\n\t\tconsole.log (\"Axis Zoom handler min:\"+ new Date(newMin) + \" max:\" + new Date (newMax));\r\n\t\tvar chart = this\r\n\t\tvar maxX,minX;\r\n\t\tvar chart=this.chart;\r\n\t\tif (chart && chart.navigator && chart.navigator.xAxis) {\r\n\t\t\tminX=chart.navigator.xAxis.min;\r\n\t\t\tmaxX=chart.navigator.xAxis.max;\r\n\t\t}\r\n\t\tvar axis = this,\r\n\t\t\tdataMin = this.dataMin,\r\n\t\t\tdataMax = this.dataMax,\r\n\t\t\toptions = this.options,\r\n\t\t\tmin = Math.min(dataMin,\r\n\t\t\tH.pick(options.min,\r\n\t\t\tdataMin),minX),\r\n\t\t\tmax = Math.max(dataMax,\r\n\t\t\tH.pick(options.max,\r\n\t\t\tdataMax),maxX),\r\n\t\t\tevt = {\r\n\t\t\t\tnewMin: newMin,\r\n\t\t\t\tnewMax: newMax\r\n\t\t\t};\r\n\t\tH.fireEvent(this, 'zoom', evt, function (e) {\r\n\t\t\t// Use e.newMin and e.newMax - event handlers may have altered them\r\n\t\t\tvar newMin = e.newMin,\r\n\t\t\t\tnewMax = e.newMax;\r\n\t\t\tif (newMin !== axis.min || newMax !== axis.max) { // #5790\r\n\t\t\t\t// Prevent pinch zooming out of range. Check for defined is for\r\n\t\t\t\t// #1946. #1734.\r\n\t\t\t\tif (!axis.allowZoomOutside) {\r\n\t\t\t\t\t// #6014, sometimes newMax will be smaller than min (or\r\n\t\t\t\t\t// newMin will be larger than max).\r\n\t\t\t\t\tif (H.defined(dataMin)) {\r\n\t\t\t\t\t\tif (newMin < min) {\r\n\t\t\t\t\t\t\tnewMin = min;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (newMin > max) {\r\n\t\t\t\t\t\t\tnewMin = max;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (H.defined(dataMax)) {\r\n\t\t\t\t\t\tif (newMax < min) {\r\n\t\t\t\t\t\t\tnewMax = min;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (newMax > max) {\r\n\t\t\t\t\t\t\tnewMax = max;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// In full view, displaying the reset zoom button is not\r\n\t\t\t\t// required\r\n\t\t\t\t//axis.displayBtn = (typeof newMin !== 'undefined' ||\r\n\t\t\t\t//\ttypeof newMax !== 'undefined');\r\n\t\t\t\taxis.displayBtn = false;\r\n\t\t\t\t// Do it\r\n\t\t\t\taxis.setExtremes(newMin, newMax, false, void 0, { trigger: 'zoom' });\r\n\t\t\t}\r\n\t\t\te.zoomed = true;\r\n\t\t});\r\n\t\treturn evt.zoomed;\r\n\t};\r\n\t\t\r\n\t/**\r\n\t * Handle touch events with two touches\r\n\t * @private\r\n\t * @function Highcharts.Pointer#pinch\r\n\t */\r\n\tH.Pointer.prototype.pinch = function (e) {\r\n\t\tconsole.log (\"Pointer pinch handler \");\r\n\t\r\n\t\tvar self = this,\r\n\t\t\tchart = self.chart,\r\n\t\t\tpinchDown = self.pinchDown,\r\n\t\t\ttouches = (e.touches || []),\r\n\t\t\ttouchesLength = touches.length,\r\n\t\t\tlastValidTouch = self.lastValidTouch,\r\n\t\t\thasZoom = self.hasZoom,\r\n\t\t\ttransform = {},\r\n\t\t\tfireClickEvent = touchesLength === 1 && ((self.inClass(e.target, 'highcharts-tracker') &&\r\n\t\t\t\tchart.runTrackerClick) ||\r\n\t\t\t\tself.runChartClick),\r\n\t\t\tclip = {};\r\n\t\tvar selectionMarker = self.selectionMarker;\r\n\t\t// Don't initiate panning until the user has pinched. This prevents us\r\n\t\t// from blocking page scrolling as users scroll down a long page\r\n\t\t// (#4210).\r\n\t\tif (touchesLength > 1) {\r\n\t\t\tself.initiated = true;\r\n\t\t}\r\n\t\telse if (touchesLength === 1 && this.followTouchMove) {\r\n\t\t\t// #16119: Prevent blocking scroll when single-finger panning is\r\n\t\t\t// not enabled\r\n\t\t\tself.initiated = false;\r\n\t\t}\r\n\t\t// On touch devices, only proceed to trigger click if a handler is\r\n\t\t// defined\r\n\t\tif (hasZoom &&\r\n\t\t\tself.initiated &&\r\n\t\t\t!fireClickEvent &&\r\n\t\t\te.cancelable !== false) {\r\n\t\t\te.preventDefault();\r\n\t\t}\r\n\t\t// Normalize each touch\r\n\t\t[].map.call(touches, function (e) {\r\n\t\t\treturn self.normalize(e);\r\n\t\t});\r\n\t\t// Register the touch start position\r\n\t\tif (e.type === 'touchstart') {\r\n\t\t\t[].forEach.call(touches, function (e, i) {\r\n\t\t\t\tpinchDown[i] = { chartX: e.chartX, chartY: e.chartY };\r\n\t\t\t});\r\n\t\t\tlastValidTouch.x = [pinchDown[0].chartX, pinchDown[1] &&\r\n\t\t\t\t\tpinchDown[1].chartX];\r\n\t\t\tlastValidTouch.y = [pinchDown[0].chartY, pinchDown[1] &&\r\n\t\t\t\t\tpinchDown[1].chartY];\r\n\t\t\t// Identify the data bounds in pixels\r\n\t\t\tchart.axes.forEach(function (axis) {\r\n\t\t\t\tif (axis.zoomEnabled) {\r\n\t\t\t\t\tvar bounds = chart.bounds[axis.horiz ? 'h' : 'v'],\r\n\t\t\t\t\t\tminPixelPadding = axis.minPixelPadding,\r\n\t\t\t\t\t\tmin = axis.toPixels(Math.min(H.pick(axis.options.min,\r\n\t\t\t\t\t\taxis.dataMin),\r\n\t\t\t\t\t\taxis.dataMin,minDate)),\r\n\t\t\t\t\t\tmax = axis.toPixels(Math.max(H.pick(axis.options.max,\r\n\t\t\t\t\t\taxis.dataMax),\r\n\t\t\t\t\t\taxis.dataMax,new Date().getTime())),\r\n\t\t\t\t\t\tabsMin = Math.min(min,\r\n\t\t\t\t\t\tmax),\r\n\t\t\t\t\t\tabsMax = Math.max(min,\r\n\t\t\t\t\t\tmax);\r\n\t\t\t\t\t// Store the bounds for use in the touchmove handler\r\n\t\t\t\t\tbounds.min = Math.min(axis.pos, absMin - minPixelPadding);\r\n\t\t\t\t\tbounds.max = Math.max(axis.pos + axis.len, absMax + minPixelPadding);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tself.res = true; // reset on next move\r\n\t\t\t// Optionally move the tooltip on touchmove\r\n\t\t}\r\n\t\telse if (self.followTouchMove && touchesLength === 1) {\r\n\t\t\tthis.runPointActions(self.normalize(e));\r\n\t\t\t// Event type is touchmove, handle panning and pinching\r\n\t\t}\r\n\t\telse if (pinchDown.length) { // can be 0 when releasing, if touchend\r\n\t\t\t// fires first\r\n\t\t\tH.fireEvent(chart, 'touchpan', { originalEvent: e }, function () {\r\n\t\t\t\t// Set the marker\r\n\t\t\t\tif (!selectionMarker) {\r\n\t\t\t\t\t// @todo It's a mock object, so maybe we need a separate\r\n\t\t\t\t\t// interface\r\n\t\t\t\t\tself.selectionMarker = selectionMarker = extend({\r\n\t\t\t\t\t\tdestroy: H.noop,\r\n\t\t\t\t\t\ttouch: true\r\n\t\t\t\t\t}, chart.plotBox);\r\n\t\t\t\t}\r\n\t\t\t\tself.pinchTranslate(pinchDown, touches, transform, selectionMarker, clip, lastValidTouch);\r\n\t\t\t\tself.hasPinched = hasZoom;\r\n\t\t\t\t// Scale and translate the groups to provide visual feedback\r\n\t\t\t\t// during pinching\r\n\t\t\t\tself.scaleGroups(transform, clip);\r\n\t\t\t});\r\n\t\t\tif (self.res) {\r\n\t\t\t\tself.res = false;\r\n\t\t\t\tthis.reset(false, 0);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n}(Highcharts));\r\n \r\n\r\nvar types = ['DOMMouseScroll', 'mousewheel'];\r\n\r\n$.event.special.mousewheel = {\r\n    setup: function() {\r\n        if ( this.addEventListener ) {\r\n            for ( var i=types.length; i; ) {\r\n                this.addEventListener( types[--i], handler, false );\r\n            }\r\n        } else {\r\n            this.onmousewheel = handler;\r\n        }\r\n    },\r\n    \r\n    teardown: function() {\r\n        if ( this.removeEventListener ) {\r\n            for ( var i=types.length; i; ) {\r\n                this.removeEventListener( types[--i], handler, false );\r\n            }\r\n        } else {\r\n            this.onmousewheel = null;\r\n        }\r\n    }\r\n};\r\n\r\n$.fn.extend({\r\n    mousewheel: function(fn) {\r\n        return fn ? this.bind(\"mousewheel\", fn) : this.trigger(\"mousewheel\");\r\n    },\r\n    \r\n    unmousewheel: function(fn) {\r\n        return this.unbind(\"mousewheel\", fn);\r\n    }\r\n});\r\n\r\n\r\nfunction handler(event) {\r\n    var orgEvent = event || window.event, args = [].slice.call( arguments, 1 ), delta = 0, returnValue = true, deltaX = 0, deltaY = 0;\r\n    event = $.event.fix(orgEvent);\r\n    event.type = \"mousewheel\";\r\n    \r\n    // Old school scrollwheel delta\r\n    if ( event.wheelDelta ) { delta = event.wheelDelta/120; }\r\n    if ( event.detail     ) { delta = -event.detail/3; }\r\n    \r\n    // New school multidimensional scroll (touchpads) deltas\r\n    deltaY = delta;\r\n    \r\n    // Gecko\r\n    if ( orgEvent.axis !== undefined && orgEvent.axis === orgEvent.HORIZONTAL_AXIS ) {\r\n        deltaY = 0;\r\n        deltaX = -1*delta;\r\n    }\r\n    \r\n    // Webkit\r\n    if ( orgEvent.wheelDeltaY !== undefined ) { deltaY = orgEvent.wheelDeltaY/120; }\r\n    if ( orgEvent.wheelDeltaX !== undefined ) { deltaX = -1*orgEvent.wheelDeltaX/120; }\r\n    \r\n    // Add event and delta to the front of the arguments\r\n    args.unshift(event, delta, deltaX, deltaY);\r\n    \r\n    return $.event.handle.apply(this, args);\r\n}\r\n  \r\n \r\n\r\n\t  \r\n\tvis.binds.photovoltaikcharts = {\r\n\t\tversion: \"1.0.9\",\r\n\t\tupdateIntervalHandler:[],\r\n\t\treloadIntervalHandler:[],\r\n\t\tdelayedRefreshHandler:[],\r\n\t\tplayHandler:[],\r\n\t\t\r\n\t\tshowVersion: function () {\r\n\t\t\tif (vis.binds.photovoltaikcharts.version) {\r\n\t\t\t\tconsole.log('Version vis-photovoltaikcharts: ' + vis.binds.photovoltaikcharts.version);\r\n\t\t\t\tvis.binds.photovoltaikcharts.version = null;\r\n\t\t\t}\r\n\t\t},\r\n\t\t\r\n\t\thighchartsOptions:{\r\n\t\t\t\tlang: {\r\n\t\t\t\t\tmonths: [\r\n\t\t\t\t\t\t'Januar', 'Februar', 'März', 'April',\r\n\t\t\t\t\t\t'Mai', 'Juni', 'Juli', 'August',\r\n\t\t\t\t\t\t'September', 'Oktober', 'November', 'Dezember'\r\n\t\t\t\t\t],\r\n\t\t\t\t\tweekdays: [\r\n\t\t\t\t\t\t'Sonntag', 'Montag', 'Dienstag', 'Mittwoch',\r\n\t\t\t\t\t\t'Donnerstag', 'Freitag', 'Samstag'\r\n\t\t\t\t\t],\r\n\t\t\t\t\tshortWeekdays:[\r\n\t\t\t\t\t\t'So', 'Mo', 'Di', 'Mi',\r\n\t\t\t\t\t\t'Do', 'Fr', 'Sa'\r\n\t\t\t\t\t],\r\n\t\t\t\t\tshortMonths:[\"Jan\", \"Feb\", \"Mrz\", \"Apr\", \"Mai\", \"Jun\",\r\n\t\t\t\t\t\t\t\t\t\t\t\"Jul\", \"Aug\", \"Sep\", \"Okt\", \"Nov\", \"Dez\"],\r\n\t\t\t\t\tcontextButtonTitle: 'Kontextmenü',\r\n\t\t\t\t\tdecimalPoint:',',\r\n\t\t\t\t\tdownloadCSV:'CSV-Datei herunterladen',\r\n\t\t\t\t\tdownloadJPEG:'JPG-Datei herunterladen',\r\n\t\t\t\t\tdownloadPDF:'PDF-Datei herunterladen',\r\n\t\t\t\t\tdownloadPNG:'PNG-Datei herunterladen',\r\n\t\t\t\t\tdownloadSVG:'SVG-Datei herunterladen',\r\n\t\t\t\t\tdownloadXLS:'XLS-Datei herunterladen',\r\n\t\t\t\t\texitFullscreen:'Vollbildanzeige beenden',\r\n\t\t\t\t\thideData: 'Datentabellen ausblenden',\r\n\t\t\t\t\tloading:'Laden...',\r\n\t\t\t\t\tnoData:'Keine Daten',\r\n\t\t\t\t\tnumericSymbols:[\"k\", \"M\", \"G\", \"T\", \"P\", \"E\"],\r\n\t\t\t\t\tprintChart:'Diagramm drucken',\r\n\t\t\t\t\tresetZoom: 'Zoom zurücksetzen',\r\n\t\t\t\t\tresetZoomTitle: 'Zoom auf 1:1 zurücksetzen',\r\n\t\t\t\t\tviewData: 'Datentabelle anzeigen',\r\n\t\t\t\t\tviewFullscreen:'Als Vollbild anzeigen',\r\n\t\t\t\t\texportData:{\r\n\t\t\t\t\t\tannotationHeader:'Anmerkungen',\r\n\t\t\t\t\t  categoryDatetimeHeader:'Datum/Zeit',\r\n\t\t\t\t\t  categoryHeader:'Kategorie'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\r\n\t\thighchartsSeriesUnits:[[\r\n\t\t\t\t\t\t\t\t\t'second',\r\n\t\t\t\t\t\t\t\t\t[1]\r\n\t\t\t\t\t\t\t\t], [\r\n\t\t\t\t\t\t\t\t\t'minute',\r\n\t\t\t\t\t\t\t\t\t[1]\r\n\t\t\t\t\t\t\t\t], [\r\n\t\t\t\t\t\t\t\t\t'hour',\r\n\t\t\t\t\t\t\t\t\t[1]\r\n\t\t\t\t\t\t\t\t], [\r\n\t\t\t\t\t\t\t\t\t'day',\r\n\t\t\t\t\t\t\t\t\t[1]\r\n\t\t\t\t\t\t\t\t], [\r\n\t\t\t\t\t\t\t\t\t'week',\r\n\t\t\t\t\t\t\t\t\t[1]\r\n\t\t\t\t\t\t\t\t], [\r\n\t\t\t\t\t\t\t\t\t'month',\r\n\t\t\t\t\t\t\t\t\t[1, 3, 6]\r\n\t\t\t\t\t\t\t\t], [\r\n\t\t\t\t\t\t\t\t\t'year',\r\n\t\t\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t\t\t\t]],\r\n\t\t\t\t\t\t\t\t\r\n\t\thighchartsDateTimeLabelFormats:{\r\n\t\t\t\t\t\tmillisecond: '%H:%M:%S.%L',\r\n\t\t\t\t\t\tsecond: '%H:%M:%S',\r\n\t\t\t\t\t\tminute: '%H:%M',\r\n\t\t\t\t\t\thour: '%H:%M',\r\n\t\t\t\t\t\tday: '%e. %b',\r\n\t\t\t\t\t\tweek: '%e. %b',\r\n\t\t\t\t\t\tmonth: '%b \\'%y',\r\n\t\t\t\t\t\tyear: '%Y'      \r\n\t\t\t\t\t},\r\n\t\tscrollspeed:0.3,\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\tgetUniqueOID: function (oidList) {\r\n\t\t\tvar result = [];\r\n\t\t\toidList.forEach(function(item) {\r\n\t\t\t\t if(result.indexOf(item.currentOID) < 0) {\r\n\t\t\t\t\t result.push(item.currentOID);\r\n\t\t\t\t }\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t},\r\n\t\t\r\n\t\tfindOID: function findOid (oidList,iod){\t\t\t\t\r\n\t\t\tvar result = [];\r\n\t\t\tfor (var i=0;i<\toidList.length;i++){\r\n\t\t\t\tif (oidList[i].currentOID + '.val'==iod) result.push (i);\r\n\t\t\t}\r\n\t\t\treturn result;\t\t\t\r\n\t\t},\r\n\r\n\t\tcreateMonthlyWidget: function (widgetID, view, data, style) {\r\n\t\t\tvar seriesData = [];\r\n\t\t\tvar oidList = [];\r\n\t\t\tvar targetArray = null;\r\n\t\t\tvar divId = 'chart_placeholder';\r\n\t\t\tvar chart = null;\r\n\r\n\t\t\tvar fbobj=this;\r\n\t\t\tconsole.log(' vis-photovoltaikcharts: Create Monthly Widget');\r\n\t\t\r\n\t\t\tvar $div = $('#' + widgetID);\r\n\t\t\t// if nothing found => wait\r\n\t\t\tif (!$div.length) {\r\n\t\t\t\treturn setTimeout(function () {\r\n\t\t\t\t\tfbobj.createMonthlyWidget(widgetID, view, data, style);\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t\tconsole.log (\"Initialize Chart Widget #\" + widgetID );\r\n\t\t\tvar systemLang = 'en';\r\n\t\t\tif (typeof sysLang !== 'undefined') {\r\n\t\t\t\tsystemLang = sysLang || 'en';\r\n\t\t\t}\r\n\t\t\tif (data.target) {\r\n\t\t\t\ttargetArray =data.target.split (',');\r\n\t\t\t}\t\t\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\toidList =[];\r\n\t\t\tseriesData=[];\r\n\t\t\tvar j=0;\r\n\t\t\tvar k;\r\n\t\t\tfor (k=1;k<=data.seriesCount;k++){\r\n\t\t\t\tif (data['serieshistoryoid'+k] && data ['instance'+ k ]){\r\n\t\t\t\t\toidList.push ({id:j, historyOID:data['serieshistoryoid' + k],instance:data ['instance'+ k ],currentOID:data ['seriescurrentoid' + k],  multiplicator:parseFloat(data ['multiplicator'+ k ]) || 1,lastX:0 });\t\t\t\t\t\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tvar today = new Date();\r\n\t\t\tvar numberOfYears=data.numberOfYears || 3;\r\n\r\n\t\t\tvar year = today.getFullYear();\r\n\t\t\tvar targetData = [[0,0,0],[0.8,0,0],[1.7,0,0],[2.6,0,0],[3.5,0,0],[4.7,0,0],[5.7,0,0],[6.7,0,0],[7.6,0,0],[8.6,0,0],[9.5,0,0],[10.4,0,0],[11.4,0,0]];\r\n\t\t\tvar categories = [year.toString(), (year-1).toString(), (year-2).toString()];\r\n\t\t\tvar categories = [];\r\n\t\t\tseriesData=[];\r\n\t\t\tfor (var i=0;i<numberOfYears;i++){\r\n\t\t\t\tcategories.push (year-i);\r\n\t\t\t\t\r\n\t\t\t\tfor (k=1;k<=data.seriesCount;k++){\r\n\t\t\t\t\tif (data['serieshistoryoid'+k] && data ['instance'+ k ]){\r\n\t\t\t\t\t\tseriesData.push ({\r\n\t\t\t\t\t\t\tname: (data['serieslabel' + k] || '') + ' ' + (year-numberOfYears+i+1).toString().substr(-2),\r\n\t\t\t\t\t\t\tdata: [0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0],\r\n\t\t\t\t\t\t\tstack: numberOfYears-i-1,\r\n\t\t\t\t\t\t\tcolor: data['yearcolor'+ k + (numberOfYears-i) ] || undefined,\r\n\t\t\t\t\t\t\tlineWidth: data['serieslinewidth'+ k] || 1,\r\n\t\t\t\t\t\t\tfillOpacity: (data['seriesopacity'+k]? parseFloat(data['seriesopacity'+k])/100 : 0.3),\r\n\t\t\t\t\t\t\ttype: data['seriesType'+k] || 'column',\r\n\t\t\t\t\t\t\topacity: 0.9\r\n\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tif (Array.isArray(targetArray)) {\r\n\t\t\t\tfor (var index = 0; index < targetArray.length; index++) {\r\n\t\t\t\t\ttargetData [index][1]=parseFloat(targetArray[index]);\r\n\t\t\t\t}\t\t\r\n\t\t\t\t\r\n\t\t\t\tseriesData.push (\r\n\t\t\t\t{\r\n\t\t\t\t\ttype: 'scatter',\r\n\t\t\t\t\tlineWidth:2,\r\n\t\t\t\t\t\t\tname: data.targetName || 'Target',\r\n\t\t\t\t\t\t\tstep: 'left',\r\n\t\t\t\t\t\t\tdata: targetData,\r\n\t\t\t\t\t\t\tcolor: '#A4A4A4',\r\n\t\t\t\t\t\t\tmarker: {\r\n\t\t\t\t\t\t\t\tenabled:false\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tif (vis.language === 'de') Highcharts.setOptions(fbobj.highchartsOptions);\r\n\t\t\t_readData(seriesData,oidList,function () {\r\n\t\t\t\t\tvar unit=data.unit;\r\n\t\t\t\t\tchart = Highcharts.chart(divId + widgetID, {\r\n\t\t\t\t\tchart: {\r\n\t\t\t\t\t\twidth: $div.width()-2,\r\n\t\t\t\t\t\theight: $div.height()-2,\r\n\t\t\t\t\t\tzoomType: 'x',\r\n\t\t\t\t\t\ttype: 'column',\r\n\t\t\t\t\t\t\t\toptions3d: {\r\n\t\t\t\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\t\t\t\talpha: data.alpha || 8,\r\n\t\t\t\t\t\t\t\t\tbeta: data.beta || 8,\r\n\t\t\t\t\t\t\t\t\tdepth: data.depth || 200,\r\n\t\t\t\t\t\t\t\t\tviewDistance: data.viewDistance || 5,\r\n\t\t\t\t\t\t\t\t\tframe: {\r\n\t\t\t\t\t\t\t\t\t\tbottom: {\r\n\t\t\t\t\t\t\t\t\t\tsize: 1,\r\n\t\t\t\t\t\t\t\t\t\tcolor: 'rgba(0,0,0,0.05)'\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\t\t\ttext: data.title\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\txAxis: {\r\n\t\t\t\t\t\t\t\t\tcategories: months [systemLang]\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tyAxis: {\r\n\t\t\t\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\t\t\t\ttext: unit\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tzAxis: {\r\n\t\t\t\t\t\t\t  min: 0,\r\n\t\t\t\t\t\t\t  max: 2,\r\n\t\t\t\t\t\t\t  labels: {\r\n\t\t\t\t\t\t\t\ty: 5,\r\n\t\t\t\t\t\t\t\trotation: 18\r\n\t\t\t\t\t\t\t  },\r\n\t\t\t\t\t\tcategories: categories\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t  plotOptions: {\r\n\t\t\t\t\t\t\t\t\tcolumn: {\r\n\t\t\t\t\t\t\t\t\t\tstacking: 'normal'\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t  series: {\r\n\t\t\t\t\t\t\tgroupZPadding: 10,\r\n\t\t\t\t\t\t\tdepth: 50,\r\n\t\t\t\t\t\t\tgroupPadding: 0.05,\r\n\t\t\t\t\t\t\tgrouping: false,\r\n\t\t\t\t\t\t  }\r\n\t\t\t\t\t  },\r\n\t\t\t\t\t\tlegend: {\r\n\t\t\t\t\t\t\tenabled: data.showLegend,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\texporting: {\r\n\t\t\t\t\t\t\tenabled: data.showMenu,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t  \r\n\t\t\t\t\t\ttooltip: {\r\n\t\t\t\t\t\t\tformatter: function () {\r\n\t\t\t\t\t\t\t\tif (this.point.stackTotal){\r\n\t\t\t\t\t\t\t\t\treturn '<b>' + this.x + ' ' + this.series.chart.zAxis[0].options.categories[this.series.userOptions.stack] +  '</b><br/>' +\r\n\t\t\t\t\t\t\t\t\t\tthis.series.name + ': ' + this.y + '<br/>' +\r\n\t\t\t\t\t\t\t\t\t\t(data.stacklabel || 'Erzeugung:') + ' ' + this.point.stackTotal +\r\n\t\t\t\t\t\t\t\t\t\t(Array.isArray(targetArray)?'<br/>' +(data.targetName || 'Target') + ': ' + targetArray[this.point.x]:'')\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\treturn '<b>' + this.x + '</b><br/>' +\r\n\t\t\t\t\t\t\t\t\t\tthis.series.name + ': ' + this.y;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tseries: seriesData,\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tcredits: {\r\n\t\t\t\t\t\t\tenabled: false\r\n\t\t\t\t\t\t}\r\n\t\t\t\t   });\t\t\t\t\t\t\r\n\r\n\t\t\t },0,1,(new Date(year-numberOfYears+1, 0, 1)).getTime());\r\n\r\n\t\t\tfunction getUniqueOID (oidList) {\r\n\t\t\t\tvar result = [];\r\n\t\t\t\toidList.forEach(function(item) {\r\n\t\t\t\t\t if(result.indexOf(item.currentOID) < 0) {\r\n\t\t\t\t\t\t result.push(item.currentOID);\r\n\t\t\t\t\t }\r\n\t\t\t\t});\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t\t\r\n            function findOid (oidList,iod){\t\t\t\t\r\n\t\t\t\tfor (var i=0;i<\toidList.length;i++){\r\n\t\t\t\t\tif (oidList[i].currentOID + '.val'==iod) return i;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\r\n\t\t\t// subscribe on updates of value\r\n\t\t\t\r\n\t\t\tfunction onChangeSeries (e, newVal, oldVal) {\r\n\t\t\t\tif (!chart || newVal==oldVal) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar ids=fbobj.findOID(oidList,e.type);\r\n\t\t\t\tfor (var i=0;i<ids.length;i++){\t\t\t\t\r\n\t\t\t\t\tchart.series[(numberOfYears-1)* oidList.length +ids[i]].data[(new Date ()).getMonth()].update((parseFloat(newVal) || 0) * oidList[ids[i]].multiplicator);\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\t\t\r\n\r\n\t\t\tvar uniqueOID=fbobj.getUniqueOID (oidList);\r\n\t\t\tfor (var i=0;i<uniqueOID.length;i++){\r\n\t\t\t\tif (uniqueOID[i]) {\r\n\t\t\t\t\tconsole.log ('register on changes for ' + uniqueOID[i]);\r\n\t\t\t\t\tvis.states.bind(uniqueOID[i] + '.val', onChangeSeries);\r\n\t\t\t\t\t$div.data('bound', [uniqueOID[i] + '.val']);\r\n\t\t\t\t\t$div.data('bindHandler', onChangeSeries);\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\tcreateYearlyWidget: function (widgetID, view, data, style) {\r\n\t\t\tvar seriesData = [];\r\n\t\t\tvar oidList = [];\r\n\t\t\tvar targetArray = null;\r\n\t\t\tvar divId = 'chart_placeholder';\r\n\t\t\tvar chart = null;\r\n\r\n\t\t\tvar fbobj=this;\r\n\t\t\tconsole.log(' vis-photovoltaikcharts: Create Yearly Widget');\r\n\t\t\r\n\t\t\tvar $div = $('#' + widgetID);\r\n\t\t\t// if nothing found => wait\r\n\t\t\tif (!$div.length) {\r\n\t\t\t\treturn setTimeout(function () {\r\n\t\t\t\t\tfbobj.createYearlyWidget(widgetID, view, data, style);\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t\tconsole.log (\"Initialize Chart Widget #\" + widgetID );\r\n\t\t\tvar systemLang = 'en';\r\n\t\t\tif (typeof sysLang !== 'undefined') {\r\n\t\t\t\tsystemLang = sysLang || 'en';\r\n\t\t\t}\r\n\r\n\t\t\tvar numberOfYears=data.numberOfYears || 4;\r\n\t\t\tvar today = new Date();\r\n\t\t\tvar year = today.getFullYear();\r\n\t\t\tvar categories = [];\r\n\t\t\tvar defaultData = [];\r\n\t\t\tfor (var i=numberOfYears-1;i>=0;i--){\r\n\t\t\t\tcategories.push (year-i);\r\n\t\t\t\tdefaultData.push (0);\r\n\t\t\t};\r\n\r\n\t\t\toidList =[];\r\n\t\t\tseriesData=[];\r\n\t\t\tvar j=0;\r\n\t\t\tvar i;\r\n\t\t\tfor (i=1;i<=data.seriesCount;i++){\r\n\t\t\t\tif (data['serieshistoryoid'+i] && data ['instance'+ i ]){\r\n\t\t\t\t\toidList.push ({id:j, historyOID:data['serieshistoryoid'+i],instance:data ['instance'+ i ],currentOID:data ['seriescurrentoid'+i],  multiplicator:parseFloat(data ['multiplicator'+ i ]) || 1,lastX:0 });\r\n\t\t\t\t\tseriesData.push ({\r\n\t\t\t\t\t\tname: data['serieslabel'+i] ,\r\n\t\t\t\t\t\tdata: defaultData.slice(0),\r\n\t\t\t\t\t\tcolor: data['seriescolor'+i] || undefined,\r\n\t\t\t\t\t\tlineWidth: data['serieslinewidth'+i] || 1,\r\n\t\t\t\t\t\tfillOpacity: (data['seriesopacity'+i]? parseFloat(data['seriesopacity'+i])/100 : 0.3),\r\n\t\t\t\t\t\ttype: data['seriesType'+i] || 'column',\r\n\t\t\t\t\t\topacity: 0.9\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\tvar plotLines=[];\r\n\t\t\tif (data.target) {\r\n\t\t\t\tplotLines.push ({color:\"#33FF50\",dashStyle:\"Solid\",label:data.targetName || 'Target',value:parseFloat(data.target),width:2});\r\n\t\t\t}\r\n\r\n\t\t\t_readData(seriesData,oidList,function () {\r\n\t\t\t\tif (vis.language === 'de') Highcharts.setOptions(fbobj.highchartsOptions);\r\n\t\t\t\tvar unit=data.unit;\r\n\t\t\t\tchart = Highcharts.chart(divId + widgetID, {\r\n\t\t\t\t\tchart: {\r\n\t\t\t\t\t\twidth: $div.width()-2,\r\n\t\t\t\t\t\theight: $div.height()-2,\r\n\t\t\t\t\t\tzoomType: 'x',\r\n\t\t\t\t\t\ttype: 'column',\r\n\t\t\t\t\t\t\t\toptions3d: {\r\n\t\t\t\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\t\t\t\talpha: data.alpha || 8,\r\n\t\t\t\t\t\t\t\t\tbeta: data.beta || 8,\r\n\t\t\t\t\t\t\t\t\tdepth: data.depth || 50,\r\n\t\t\t\t\t\t\t\t\tviewDistance: data.viewDistance || 5,\r\n\t\t\t\t\t\t\t\t\tframe: {\r\n\t\t\t\t\t\t\t\t\t\tbottom: {\r\n\t\t\t\t\t\t\t\t\t\tsize: 1,\r\n\t\t\t\t\t\t\t\t\t\tcolor: 'rgba(0,0,0,0.05)'\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\t\t\ttext: data.title\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\txAxis: {\r\n\t\t\t\t\t\t\t\t\tcategories: categories\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tyAxis: {\r\n\t\t\t\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\t\t\t\ttext: unit\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tplotLines:plotLines\r\n\r\n\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t  series: {\r\n\t\t\t\t\t\t\tgroupZPadding: 10,\r\n\t\t\t\t\t\t\tdepth: 50,\r\n\t\t\t\t\t\t\tgroupPadding: 0.05,\r\n\t\t\t\t\t\t\tgrouping: false,\r\n\t\t\t\t\t\t  },\r\n\t\t\t\t\tlegend: {\r\n\t\t\t\t\t\tenabled: data.showLegend,\r\n\t\t\t\t\t},\r\n\t\t\t\t\texporting: {\r\n\t\t\t\t\t\tenabled: data.showMenu,\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\t  \r\n\t\t\t\t\ttooltip: {\r\n\t\t\t\t\t\tformatter: function () {\r\n\t\t\t\t\t\t\tif (this.point.stackTotal){\r\n\t\t\t\t\t\t\t\treturn '<b>' + this.x + ' ' + this.series.chart.zAxis[0].options.categories[this.series.userOptions.stack] +  '</b><br/>' +\r\n\t\t\t\t\t\t\t\t\tthis.series.name + ': ' + this.y + '<br/>' +\r\n\t\t\t\t\t\t\t\t\t(data.stacklabel || 'Erzeugung:') + ' ' + this.point.stackTotal +\r\n\t\t\t\t\t\t\t\t\t(Array.isArray(targetArray)?'<br/>' +(data.targetName || 'Target') + ': ' + targetArray[this.point.x]:'')\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\treturn '<b>' + this.x + '</b><br/>' +\r\n\t\t\t\t\t\t\t\t\tthis.series.name + ': ' + this.y;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\t\t\t\t\t\t\t\r\n\t\t\t\t\tseries: seriesData,\r\n\t\t\t\t\t\r\n\t\t\t\t\tcredits: {\r\n\t\t\t\t\t\tenabled: false\r\n\t\t\t\t\t}\r\n\t\t\t\t});\t\t\t\t\t\t\r\n\r\n\t\t\t },0,2,(new Date(year-numberOfYears+1, 0, 1)).getTime());\r\n\r\n  \r\n\r\n\t\t\t// subscribe on updates of value\r\n\t\t\t\r\n\t\t\tfunction onChangeSeries (e, newVal, oldVal) {\r\n\t\t\t\tif (!chart || newVal==oldVal) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar ids=fbobj.findOID(oidList,e.type);\r\n\t\t\t\tvar eventDate=normalizeDate (new Date (),data.normalizeDate);\r\n\t\t\t\tfor (var i=0;i<ids.length;i++){\t\t\t\t\r\n\t\t\t\t\t//console.log ('add new series ' + (ids[i]+1) + ' value :' + eventDate + '(' + eventDate.getTime() + ') - ' + newVal);\r\n\t\t\t\t\tchart.series[ids[i]].data[numberOfYears-1].update((parseFloat(newVal) || 0) * oidList[ids[i]].multiplicator);\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tvar uniqueOID=fbobj.getUniqueOID (oidList);\r\n\t\t\tfor (var i=0;i<uniqueOID.length;i++){\r\n\t\t\t\tif (uniqueOID[i]) {\r\n\t\t\t\t\tconsole.log ('register on changes for ' + uniqueOID[i]);\r\n\t\t\t\t\tvis.states.bind(uniqueOID[i] + '.val', onChangeSeries);\r\n\t\t\t\t\t$div.data('bound', [uniqueOID[i] + '.val']);\r\n\t\t\t\t\t$div.data('bindHandler', onChangeSeries);\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\r\n\t\t\t \t\t\t \r\n\t\t},\r\n\t\t\r\n\t\tcreateTimeseriesWidget: function (widgetID, view, data, style) {\r\n\t\t\tvar seriesData = [];\r\n\t\t\tvar oidList = [];\r\n\t\t\tvar targetArray = null;\r\n\t\t\tvar divId = 'chart_placeholder';\r\n\t\t\tvar chart = null;\r\n\t\t\tvar fbobj=this;\r\n\t\t\tvar loadRunning=false;\r\n\t\t\tvar refreshRequired=false;\r\n\t\t\tvar lastEvent=null;\r\n\t\t\tvar loadWaiting=false;\r\n\t\t\tvar navigationData=[];\r\n\t\t\tvar zoomlevel ={\"1d\":0,\"3d\":1,\"7d\":2,\"1m\":3,\"3m\":4,\"6m\":5,\"ytd\":6,\"1y\":7,\"all\":8};\r\n\t\t\t\r\n\t\t\tconsole.log(' photovoltaikcharts: Create Timeseries Widget');\r\n\t\t\r\n\t\t\tvar $div = $('#' + widgetID);\r\n\t\t\t// if nothing found => wait\r\n\t\t\tif (!$div.length) {\r\n\t\t\t\treturn setTimeout(function () {\r\n\t\t\t\t\tfbobj.createTimeseriesWidget(widgetID, view, data, style);\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t\tconsole.log (\"Initialize Chart Widget #\" + widgetID );\r\n\t\t\tvar systemLang = 'en';\r\n\t\t\tif (typeof sysLang !== 'undefined') {\r\n\t\t\t\tsystemLang = sysLang || 'en';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\toidList =[];\r\n\t\t\tseriesData=[];\r\n\t\t\tvar j=0;\r\n\t\t\tvar i;\r\n\t\t\tfor (i=1;i<=data.seriesCount;i++){\r\n\t\t\t\tif (data['serieshistoryoid'+i] && data ['instance'+ i ]){\r\n\t\t\t\t\toidList.push ({id:j, historyOID:data['serieshistoryoid'+i],instance:data ['instance'+ i ],currentOID:data ['seriescurrentoid'+i],  multiplicator:parseFloat(data ['multiplicator'+ i ]) || 1,lastX:0 });\r\n\t\t\t\t\tseriesData.push ({\r\n\t\t\t\t\t\tname: data['serieslabel'+i] ,\r\n\t\t\t\t\t\tboostThreshold:1,\r\n\t\t\t\t\t\tdata: [],\r\n\t\t\t\t\t\tcolor: data['seriescolor'+i] || '#FF5A33',\r\n\t\t\t\t\t\tlineWidth: data['serieslinewidth'+i] || 1,\r\n\t\t\t\t\t\tfillOpacity: (data['seriesopacity'+i]? parseFloat(data['seriesopacity'+i])/100 : 0.3),\r\n\t\t\t\t\t\ttype: data['seriesType'+i] || 'areaspline',\r\n\t\t\t\t\t\tyAxis:(data['seriesaxis'+i]? parseInt(data['seriesaxis'+i]): 0),\r\n\t\t\t\t\t\tstep: (data['seriesstep'+i] && data['seriesstep'+i]!='no'?data['seriesstep'+i]: undefined),\r\n\t\t\t\t\t\tstacking: (data['seriesstacking'+i] && data['seriesstacking'+i]!='no' ? data['seriesstacking'+i] :undefined),\r\n\t\t\t\t\t\tdataGrouping: {\r\n\t\t\t\t\t\t\tenabled: data['seriesgrouping'+i],\r\n\t\t\t\t\t\t\tapproximation:\"high\",\r\n\t\t\t\t\t\t\tunits:(data['seriesType'+i]!='column' ? fbobj.highchartsSeriesUnits:undefined)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tstates: {\t\r\n\t\t\t\t\t\t\thover: {\r\n\t\t\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\t\t\tlineWidth: data['serieshoverlinewidth'+i] || 1,\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tpointInterval:10000\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tvar plotLines=[];\r\n\t\t\tif (data.target) {\r\n\t\t\t\tplotLines.push ({color:\"#33FF50\",dashStyle:\"Solid\",label:data.targetName || 'Target',value:parseFloat(data.target),width:2});\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t\tfunction loadSeriesData (start,end,callback) {\r\n\t\t\t\tconsole.log ('resize chart to ' + new Date (start) + ' - ' + new Date (end));\r\n\t\t\t\tloadWaiting=false;\r\n\t\t\t\tif (start && end){\r\n\t\t\t\t\tloadRunning=true;\r\n\t\t\t\t\tvar virtualStart=start;\r\n\t\t\t\t\tvar virtualEnd=end;\r\n\t\t\t\t\tchart.showLoading();\r\n\t\t\t\t\twindow.setTimeout(function (){ \r\n\t\t\t\t\t\tloadSeriesRange(chart,oidList,0,data.normalizeDate,start,end,virtualStart,virtualEnd,function () {\r\n\t\t\t\t\t\t\tchart.redraw();\r\n\t\t\t\t\t\t\tchart.hideLoading();\r\n\t\t\t\t\t\t\tloadRunning=false;\r\n\t\t\t\t\t\t\tif (callback) callback();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},10);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\r\n\t\t\t/**\r\n\t\t\t * Load new data depending on the selected min and max\r\n\t\t\t */\r\n\t\t\t\r\n\t\t\tif (fbobj.delayedRefreshHandler[widgetID]) window.clearInterval(fbobj.delayedRefreshHandler[widgetID]);\t\t\t\t\t\t\r\n\t\t\tfbobj.delayedRefreshHandler[widgetID]=window.setInterval( function () {\r\n\t\t\t\tif (loadRunning==false && refreshRequired==true) {\r\n   \t\t\t\t   refreshRequired=false;\r\n  \t\t\t\t   console.log ('Process event ' + new Date (lastEvent.min) + ' - ' + new Date (lastEvent.max));\t\t\t\t   \r\n\t\t\t\t   loadSeriesData (lastEvent.min,lastEvent.max);\r\n\t\t\t\t   \r\n\t\t\t\t} \t\r\n\t\t\t},500);\r\n\r\n\r\n\t\t\tfunction afterSetExtremes(event) {\r\n\t\t\t\tconsole.log ('afterSetExtremes event ' + new Date (event.min) + ' - ' + new Date (event.max)+ ' - ' + event.trigger);\r\n\t\t\t\tif (event.trigger!=undefined){\r\n\t\t\t\t\tif (!loadRunning) {\r\n\t\t\t\t\t\tloadSeriesData (event.min,event.max);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlastEvent=event;\r\n\t\t\t\t\t\tconsole.log ('Save event ' + new Date (event.min) + ' - ' + new Date (event.max));\r\n\r\n\t\t\t\t\t\trefreshRequired=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction setExtremes(event) {\r\n\t\t\t\tconsole.log ('setExtremes event ' + new Date (event.min) + ' - ' + new Date (event.max)+ ' - ' + event.trigger);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (vis.language === 'de')Highcharts.setOptions(fbobj.highchartsOptions);\r\n\t\t\tvar unit = data.unit;\r\n\t\t\tchart = Highcharts.stockChart(divId + widgetID, {\r\n\t\t\t\tchart: {\r\n\t\t\t\t\twidth: $div.width()-2,\r\n\t\t\t\t\theight: $div.height()-2,\r\n\t\t\t\t\tzoomType: 'x',\r\n\t\t\t\t\trenderTo: divId + widgetID,\r\n\t\t\t\t\tpanning: true,\r\n\t\t\t\t\tpanKey: 'shift'\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\ttitle: {\r\n\t\t\t\t\ttext: data.title\r\n\t\t\t\t},\r\n\t\t\t\ttime:{\r\n\t\t\t\t   timezoneOffset:(data.normalizeDate=='no' ||data.normalizeDate=='hour' ? new Date().getTimezoneOffset() : 0 )\r\n\t\t\t\t},\r\n\t\t\t\trangeSelector: {\r\n\t\t\t\t  buttons: [{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 1,\r\n\t\t\t\t\t\ttext: '1 Tag',\r\n\t\t\t\t\t\ttitle: '1 Tag anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 3,\r\n\t\t\t\t\t\ttext: '3 Tage',\r\n\t\t\t\t\t\ttitle: '3 Tage anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 7,\r\n\t\t\t\t\t\ttext: '7 Tage',\r\n\t\t\t\t\t\ttitle: '7 Tage anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 1,\r\n\t\t\t\t\t\ttext: '1M',\r\n\t\t\t\t\t\ttitle: '1 Monat anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 3,\r\n\t\t\t\t\t\ttext: '3M',\r\n\t\t\t\t\t\ttitle: '3 Monate anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 6,\r\n\t\t\t\t\t\ttext: '6M',\r\n\t\t\t\t\t\ttitle: '6 Monate anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'ytd',\r\n\t\t\t\t\t\ttext: 'Aktuelles Jahr',\r\n\t\t\t\t\t\ttitle: 'Aktuelles Jahr anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'year',\r\n\t\t\t\t\t\tcount: 1,\r\n\t\t\t\t\t\ttext: '1 Jahr',\r\n\t\t\t\t\t\ttitle: '1 Jahr anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'all',\r\n\t\t\t\t\t\ttext: 'Alles',\r\n\t\t\t\t\t\ttitle: 'Alles anzeigen'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tallButtonsEnabled: true,\r\n\t\t\t\t\tdropdown:'always',\r\n\t\t\t\t\theight: 10,\r\n\t\t\t\t\tselected: zoomlevel[data.zoomDefault],\r\n\t\t\t\t\tinputDateFormat:'%e. %b %Y'\r\n\t\t\t\t},\r\n\t\t\t\tnavigator: {\r\n\t\t\t\t\tadaptToUpdatedData:false,\r\n\t\t\t\t\theight: 20,\r\n\t\t\t\t\tmargin: 10,\r\n\t\t\t\t\tseries: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdata: null,\r\n\t\t\t\t\t\t\tlineColor: data.navcolor,\r\n\t\t\t\t\t\t\tdataGrouping: {\r\n\t\t\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\t\t\tapproximation:\"high\",\r\n\t\t\t\t\t\t\t\tunits:fbobj.highchartsSeriesUnits\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tpointInterval:10000\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t],\r\n\t\t\t\t\txAxis:{\r\n\t\t\t\t\t\tordinal: false\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tscrollbar: {\r\n\t\t\t\t\tenabled: false\r\n\t\t\t\t},\r\n\t\t\t\txAxis: {\r\n\t\t\t\t\tevents: {\r\n\t\t\t\t\t\tafterSetExtremes: afterSetExtremes,\r\n\t\t\t\t\t\tsetExtremes: setExtremes\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdateTimeLabelFormats:  fbobj.highchartsDateTimeLabelFormats,\r\n\t\t\t\t\toverscroll: 10000,\r\n\t\t\t\t\tordinal: false\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tyAxis: [{\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\tformatter: function () {\r\n\t\t\t\t\t\t\treturn this.value + (unit ? ' ' + unit : '');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\talign: 'left'\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\ttext: 'Produktion'\r\n\t\t\t\t\t},\r\n\t\t\t\t\theight: (data.chart1Height? data.chart1Height+'%':'48%'),\r\n\t\t\t\t\tlineWidth: 2,\r\n\t\t\t\t\tresize: {\r\n\t\t\t\t\t\tenabled: true\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tplotLines:plotLines,\r\n\t\t\t\t\tmin: (data.yAxis1min?parseFloat(data.yAxis1min):undefined),\r\n\t\t\t\t\tmax: (data.yAxis1max?parseFloat(data.yAxis1max):undefined),\r\n\t\t\t\t\ttickAmount: (data.yAxis1tickamount?data.yAxis1tickamount:undefined),\r\n\t\t\t\t\tminorTicks: true\r\n\t\t\r\n\t\t\t\t},{\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\tformatter: function () {\r\n\t\t\t\t\t\t\treturn this.value + ' ' + unit;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\talign: 'left'\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\ttext: 'Verbrauch'\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttop: (data.chart1Height? parseFloat (data.chart1Height) + ((data.chartspacing? parseFloat(data.chartspacing) :4))+ '%': (48 + (data.chartspacing? parseFloat(data.chartspacing) :5))+'%'),\r\n\t\t\t\t\theight: (data.chart2Height? data.chart2Height+'%':'48%'),\r\n\t\t\t\t\toffset: 0,\r\n\t\t\t\t\tlineWidth: 2,\r\n\t\t\t\t\tmin: (data.yAxis2min?parseFloat(data.yAxis2min):undefined),\r\n\t\t\t\t\tmax: (data.yAxis2max?parseFloat(data.yAxis2max):undefined),\r\n\t\t\t\t\ttickAmount: (data.yAxis2tickamount?data.yAxis2tickamount:undefined),\r\n\t\t\t\t\tminorTicks: true\r\n\t\t\t\t}\r\n\t\t\t\t],\r\n\r\n\t\t\t\tplotOptions: {\r\n\t\t\t\t},\r\n\t\t\t\tlegend: {\r\n\t\t\t\t\tenabled: data.showLegend,\r\n\t\t\t\t\talign: 'left',\r\n\t\t\t\t\tverticalAlign: 'top',\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 20,\r\n\t\t\t\t\tfloating: true,\r\n\t\t\t\t\titemStyle: (data.legendItemStyle?JSON.parse(data.legendItemStyle):{\"color\": \"#333333\", \"cursor\": \"pointer\", \"fontSize\": \"12px\", \"fontWeight\": \"bold\", \"textOverflow\": \"ellipsis\"}),\t\t\t\t\r\n\t\t\t\t\titemDistance : (data.legendItemDistance?parseInt(data.legendItemDistance):undefined)\r\n\t\t\t\t},\r\n\t\t\t\texporting: {\r\n\t\t\t\t\tenabled: data.showMenu,\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tcredits: {\r\n\t\t\t\t   enabled: false\r\n\t\t\t\t},\r\n\t\t\t\ttooltip: {\r\n\t\t\t\t\tpointFormat: '<span style=\"color:{series.color}\">{series.name}</span>: <b>{point.y}</b><br/>',\r\n\t\t\t\t\tvalueDecimals: 2,\r\n\t\t\t\t\tsplit: true,\r\n\t\t\t\t\tfollowTouchMove:false,\r\n\t\t\t\t\tdateTimeLabelFormats: fbobj.highchartsDateTimeLabelFormats\r\n\t\t\t\t},\r\n\r\n\t\t\t\tseries: seriesData\r\n\t\t\t});\r\n\r\n\r\n\t\t\twindow.setTimeout(function (){\r\n\t\t\t\tloadSelectorData (navigationData,oidList[0].historyOID,oidList[0].instance,oidList[0].currentOID,oidList[0].multiplicator,data.normalizeDate,(data.navigatorRange? parseInt (data.navigatorRange): 48),function (){\t\t\t\t\t\r\n\t\t\t\t\tchart.navigator.series[0].setData (navigationData);\t\t\t\t\r\n\t\t\t\t\tchart.navigator.series[0].xAxis.min=navigationData[0][0];\r\n\t\t\t\t\tif (data.navcolor)chart.navigator.series[0].color=data.navcolor;\r\n\t\t\t\t\tvar startDate=new Date ();\r\n\t\t\t\t\tstartDate.setUTCMilliseconds(0);\r\n\t\t\t\t\tstartDate.setUTCSeconds(0);\t\r\n\t\t\t\t\tif (data.zoomDefault==\"1d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-1);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"7d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-7);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"3d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-3);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"1m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-1);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"3m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-3);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"6m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-6);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"ytd\"){\r\n\t\t\t\t\t\tstartDate=new Date (startDate.getFullYear(),0,1);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"1y\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-12);\r\n\t\t\t\t\t}else if (data.zoomDefault==\"all\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-120);\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tloadSeriesData (startDate.getTime(),new Date ().getTime());\t\t\t\t\r\n\r\n\t\t\t\t\t//add mouse wheel support\r\n\t\t\t\t\tvar zoomRatio = 0;\r\n\t\t\t\t\tvar lastX;\r\n\t\t\t\t\tvar lastY;\r\n\r\n\t\t\t\t\t$('#'+ divId + widgetID).mousewheel(function(objEvent, intDelta) {\r\n\t\t\t\t\t\tif (intDelta > 0) {\r\n\t\t\t\t\t\t\tzoomRatio = -1 * fbobj.scrollspeed;\r\n\t\t\t\t\t\t\tsetZoom();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (intDelta < 0) {\r\n\t\t\t\t\t\t\tzoomRatio = fbobj.scrollspeed;\r\n\t\t\t\t\t\t\tsetZoom();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar setZoom = function() {\r\n\r\n\t\t\t\t\t\tvar xMin = chart.xAxis[0].getExtremes().dataMin;\r\n\t\t\t\t\t\tvar xMax = chart.xAxis[0].getExtremes().dataMax;\r\n\t\t\t\t\t\tvar absMin = minDate;\r\n\t\t\t\t\t\tvar absMax = new Date ().getTime();\r\n\t\t\t\t\t   \r\n\t\t\t\t\t\tchart.xAxis[0].setExtremes(Math.max (absMin ,xMin - zoomRatio * (xMax-xMin)), Math.min (absMax, xMax + zoomRatio * (xMax-xMin)), true, true, { trigger: 'zoom' });\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\t\t\t},10);\r\n\r\n\t\t\t\r\n\r\n\t\t\t// subscribe on updates of value\r\n\t\t\t\r\n\t\t\tfunction onChangeSeries (e, newVal, oldVal) {\r\n\t\t\t\tif (!chart || newVal==oldVal) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tvar ids=fbobj.findOID(oidList,e.type);\r\n\t\t\t\tvar eventDate=normalizeDate (new Date (),data.normalizeDate);\r\n\t\t\t\tfor (var i=0;i<ids.length;i++){\t\t\t\t\r\n\t\t\t\t\t//console.log ('add new series ' + (ids[i]+1) + ' value :' + eventDate + '(' + eventDate.getTime() + ') - ' + newVal);\r\n\t\t\t\t\tif (ids[i]==0) {\r\n\r\n\t\t\t\t\t\tif (chart.navigator.series[0].points && chart.navigator.series[0].points.length>0 && chart.navigator.series[0].points [chart.navigator.series[0].points.length-1]) console.log ('Last old x:' + chart.navigator.series[0].points[chart.navigator.series[0].points.length-1].x );\r\n\r\n\t\t\t\t\t\tif (chart.navigator.series[0].points && chart.navigator.series[0].points.length>0 && chart.navigator.series[0].points [chart.navigator.series[0].points.length-1] && chart.navigator.series[0].points[chart.navigator.series[0].points.length-1].x==eventDate.getTime()){\r\n\t\t\t\t\t\t\tchart.navigator.series[0].points[chart.navigator.series[0].points.length-1].update((parseFloat(newVal) || 0) * oidList[ids[i]].multiplicator, false, false);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tchart.navigator.series[0].addPoint ([eventDate.getTime(),(parseFloat(newVal) || 0) * oidList[ids[i]].multiplicator]); \r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (chart.series[ids[i]].points && chart.series[ids[i]].points[chart.series[ids[i]].points.length-1] && chart.series[ids[i]].points[chart.series[ids[i]].points.length-1].x==eventDate.getTime() && typeof chart.series[ids[i]].points[chart.series[ids[i]].points.length-1].update === \"function\"){\r\n\t\t\t\t\t\t\tconsole.log ('V1 Update series ' + (ids[i]+1));\t\t\t\r\n\t\t\t\t\t\t\tchart.series[ids[i]].points[chart.series[ids[i]].points.length-1].update((parseFloat(newVal) || 0) * oidList[ids[i]].multiplicator, false, false);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log ('Add new value to series 1');\r\n\t\t\t\t\t\t\tif (chart && chart.xAxis && typeof chart.xAxis[0] != 'undefined') {\r\n\t\t\t\t\t\t\t\tvar oldExtremes=chart.xAxis[0].getExtremes();\r\n\t\t\t\t\t\t\t\tconsole.log ('Old extremes: ' + JSON.stringify (oldExtremes));\r\n\t\t\t\t\t\t\t\tvar oldLastX=chart.navigator.xAxis.max ;\r\n\t\t\t\t\t\t\t\tconsole.log ('Last X: ' + new Date (oldLastX));\r\n\t\t\t\t\t\t\t\tconsole.log ('CompareX: ' + JSON.stringify (oldExtremes));\r\n\t\t\t\t\t\t\t\tconsole.log ('oldExtremes max: ' + new Date (oldExtremes.max));\r\n\t\t\t\t\t\t\t\tif (oldExtremes.max > oldLastX-(10*60*1000)){\r\n\t\t\t\t\t\t\t\t\t//chart.xAxis[0].setExtremes(oldExtremes.min+eventDate.getTime()-oldExtremes.max,eventDate.getTime());\r\n\t\t\t\t\t\t\t\t\tchart.series[ids[i]].addPoint ([eventDate.getTime(),(parseFloat(newVal) || 0) * oidList[ids[i]].multiplicator]); \r\n\t\t\t\t\t\t\t\t\tvar newMaxX=chart.navigator.xAxis.max;\r\n\t\t\t\t\t\t\t\t\tif (oldLastX!=newMaxX) chart.xAxis[0].setExtremes(oldExtremes.min+newMaxX-oldExtremes.max,newMaxX);\r\n\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (chart.series[ids[i]].points && chart.series[ids[i]].points[chart.series[ids[i]].points.length-1] && chart.series[ids[i]].points[chart.series[ids[i]].points.length-1].x==eventDate.getTime() && typeof chart.series[ids[i]].points[chart.series[ids[i]].points.length-1].update === \"function\"){\r\n\t\t\t\t\t\t\tchart.series[ids[i]].points[chart.series[ids[i]].points.length-1].update((parseFloat(newVal) || 0) * oidList[ids[i]].multiplicator, false, false);\r\n\t\t\t\t\t\t} else {   \t\t\t\t\r\n\t\t\t\t\t\t\tif (chart && chart.xAxis && typeof chart.xAxis[1] != 'undefined') {\r\n\t\t\t\t\t\t\t\tvar oldExtremes=chart.xAxis[1].getExtremes();\r\n\t\t\t\t\t\t\t\tvar oldLastX=(chart.series && chart.series[ids[i]].points && chart.series[ids[i]].points.length>0 && chart.series[ids[i]].points[chart.series[ids[i]].points.length-1] && chart.series[ids[i]].points[chart.series[ids[i]].points.length-1].x? chart.series[ids[i]].points[chart.series[ids[i]].points.length-1].x:0);\r\n\t\t\t\t\t\t\t\tif (oldExtremes.max > oldLastX-(10*60*1000)){\r\n\t\t\t\t\t\t\t\t\tchart.series[ids[i]].addPoint ([eventDate.getTime(),(parseFloat(newVal) || 0) * oidList[ids[i]].multiplicator]); \r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\r\n\t\t\tvar uniqueOID=fbobj.getUniqueOID (oidList);\r\n\t\t\tfor (var i=0;i<uniqueOID.length;i++){\r\n\t\t\t\tif (uniqueOID[i]) {\r\n\t\t\t\t\tconsole.log ('register on changes for ' + uniqueOID[i]);\r\n\t\t\t\t\tvis.states.bind(uniqueOID[i] + '.val', onChangeSeries);\r\n\t\t\t\t\t$div.data('bound', [uniqueOID[i] + '.val']);\r\n\t\t\t\t\t$div.data('bindHandler', onChangeSeries);\r\n\t\t\t\t}\t\t\t\r\n\t\t\t}\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\t\r\n\t\tcreateTimeseries2Widget: function (widgetID, view, data, style) {\r\n\t\t\tvar seriesData = [];\r\n\t\t\tvar oidList = [];\r\n\t\t\tvar targetArray = null;\r\n\t\t\tvar divId = 'chart_placeholder';\r\n\t\t\tvar chart = null;\r\n\t\t\tvar fbobj=this;\r\n\t\t\tvar loadRunning=false;\r\n\t\t\tvar loadWaiting=false;\r\n\t\t\tvar refreshRequired=false;\r\n\t\t\tvar lastEvent=null;\t\t\t\r\n\t\t\tvar navigationData=[];\r\n\t\t\tvar zoomlevel ={\"1d\":0,\"3d\":1,\"7d\":2,\"1m\":3,\"3m\":4,\"6m\":5};\r\n\t\t\t\r\n\t\t\tconsole.log(' photovoltaikcharts: Create Timeseries2 Widget');\r\n\t\t\r\n\t\t\tvar $div = $('#' + widgetID);\r\n\t\t\t// if nothing found => wait\r\n\t\t\tif (!$div.length) {\r\n\t\t\t\treturn setTimeout(function () {\r\n\t\t\t\t\tfbobj.createTimeseries2Widget(widgetID, view, data, style);\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t\tconsole.log (\"Initialize Chart Widget #\" + widgetID );\r\n\t\t\tvar systemLang = 'en';\r\n\t\t\tif (typeof sysLang !== 'undefined') {\r\n\t\t\t\tsystemLang = sysLang || 'en';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar navigator={id:0, historyOID:data.navhistoryoid,instance:data.navinstance,multiplicator:parseFloat(data.navmultiplicator) || 1 };\r\n\t\t\t\r\n\t\t\toidList =[];\r\n\t\t\tseriesData=[];\r\n\t\t\tvar j=0;\r\n\t\t\tvar i;\r\n\t\t\tfor (i=1;i<=data.seriesCount;i++){\r\n\t\t\t\tif (data['serieshistoryoid'+i] && data ['instance'+ i ]){\r\n\t\t\t\t\toidList.push ({id:j, historyOID:data['serieshistoryoid'+ i],instance:data ['instance'+ i ],multiplicator:parseFloat(data ['multiplicator'+ i ]) || 1,lastX:0 });\r\n\t\t\t\t\t\r\n\t\t\t\t\tseriesData.push ({\r\n\t\t\t\t\t\tname: data['serieslabel'+ i] ,\r\n\t\t\t\t\t\tboostThreshold:1,\r\n\t\t\t\t\t\tdata: [],\r\n\t\t\t\t\t\tcolor: data['seriescolor'+ i] || '#FF5A33',\r\n\t\t\t\t\t\tlineWidth: data['serieslinewidth'+ i] || 1,\r\n\t\t\t\t\t\tfillOpacity: (data['seriesopacity'+ i]? parseFloat(data['seriesopacity'+ i])/100 : 0.3),\r\n\t\t\t\t\t\ttype: data['seriesType'+ i] || 'areaspline',\r\n\t\t\t\t\t\tyAxis:(data['seriesaxis'+ i]? parseInt(data['seriesaxis'+i]): 0),\r\n\t\t\t\t\t\tstep: (data['seriesstep'+ i] && data['seriesstep'+i]!='no'?data['seriesstep'+ i]: undefined),\r\n\t\t\t\t\t\tstacking: (data['seriesstacking'+ i] && data['seriesstacking'+ i]!='no'  ? data['seriesstacking'+ i] :undefined),\r\n\t\t\t\t\t\tdataGrouping: {\r\n\t\t\t\t\t\t\tenabled: data['seriesgrouping'+i],\r\n\t\t\t\t\t\t\tapproximation:\"high\",\r\n\t\t\t\t\t\t\tunits:(data['seriesType'+i]!='column' ? fbobj.highchartsSeriesUnits:undefined)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tstates: {\t\r\n\t\t\t\t\t\t\thover: {\r\n\t\t\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\t\t\tlineWidth: data['serieshoverlinewidth'+ i] || 1,\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tpointInterval:10000\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tvar plotLines=[];\r\n\t\t\tif (data.target) {\r\n\t\t\t\tplotLines.push ({color:\"#33FF50\",dashStyle:\"Solid\",label:data.targetName || 'Target',value:parseFloat(data.target),width:2});\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t\tfunction loadSeriesData (start,end,callback) {\r\n\t\t\t\tconsole.log ('resize chart to ' + new Date (start) + ' - ' + new Date (end));\r\n\t\t\t\tloadWaiting=false;\r\n\t\t\t\tif (start && end){\r\n\t\t\t\t\tloadRunning=true;\r\n\t\t\t\t\tvar virtualStart=start;\r\n\t\t\t\t\tvar virtualEnd=end;\r\n\t\t\t\t\tconsole.log ('virtual chart size ' + new Date (virtualStart) + ' - ' + new Date (virtualEnd));\r\n\r\n\t\t\t\t\tchart.showLoading();\r\n\t\t\t\t\twindow.setTimeout(function (){ \r\n\t\t\t\t\t\tloadSeriesRange(chart,oidList,0,data.normalizeDate,start,end,virtualStart,virtualEnd,function () {\r\n\t\t\t\t\t\t\tchart.redraw();\r\n\t\t\t\t\t\t\tchart.hideLoading();\r\n\t\t\t\t\t\t\tloadRunning=false;\r\n\t\t\t\t\t\t\tif (callback) callback();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},10);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\t\r\n\t\t\t/**\r\n\t\t\t * Load new data depending on the selected min and max\r\n\t\t\t */\r\n\t\t\tif (fbobj.delayedRefreshHandler[widgetID]) window.clearInterval(fbobj.delayedRefreshHandler[widgetID]);\t\t\t\t\t\t\r\n\t\t\tfbobj.delayedRefreshHandler[widgetID]=window.setInterval( function () {\r\n\t\t\t\tif (loadRunning==false && refreshRequired==true) {\r\n   \t\t\t\t   refreshRequired=false;\r\n  \t\t\t\t   console.log ('Process event ' + new Date (lastEvent.min) + ' - ' + new Date (lastEvent.max));\t\t\t\t   \r\n\t\t\t\t   loadSeriesData (lastEvent.min,lastEvent.max);\r\n\t\t\t\t   \r\n\t\t\t\t} \t\r\n\t\t\t},500);\r\n\r\n\t\t\tfunction afterSetExtremes(event) {\r\n\t\t\t\tconsole.log ('afterSetExtremes event ' + new Date (event.min) + ' - ' + new Date (event.max)+ ' - ' + event.trigger);\r\n\t\t\t\tif (event.trigger!=undefined){\r\n\t\t\t\t\tif (!loadRunning) {\r\n\t\t\t\t\t\tloadSeriesData (event.min,event.max);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlastEvent=event;\r\n\t\t\t\t\t\tconsole.log ('Save event ' + new Date (event.min) + ' - ' + new Date (event.max));\r\n\r\n\t\t\t\t\t\trefreshRequired=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction setExtremes(event) {\r\n\t\t\t\tconsole.log ('setExtremes event ' + new Date (event.min) + ' - ' + new Date (event.max)+ ' - ' + event.trigger);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tif (vis.language === 'de') Highcharts.setOptions(fbobj.highchartsOptions);\r\n\t\t\tvar yAxis = [{\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\tformatter: function () {\r\n\t\t\t\t\t\t\treturn this.value + (data.unit1 ? ' ' + data.unit1 : '')\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\talign: 'left',\r\n\t\t\t\t\t\tx: 1\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\ttext: data.xAxisLabel1\r\n\t\t\t\t\t},\r\n\t\t\t\t\theight: (data.chart1Height? data.chart1Height+'%':'20%'),\r\n\t\t\t\t\tlineWidth: 1,\r\n\t\t\t\t\tresize: {\r\n\t\t\t\t\t\tenabled: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcategories:(data.yAxis1Categories? JSON.parse (data.yAxis1Categories): undefined),\r\n\t\t\t\t\toffset: 0,\r\n\t\t\t\t\tmin: (data.yAxis1min?parseFloat(data.yAxis1min):undefined),\r\n\t\t\t\t\tmax: (data.yAxis1max?parseFloat(data.yAxis1max):undefined),\r\n\t\t\t\t\ttickAmount: (data.yAxis1tickamount?data.yAxis1tickamount:undefined),\r\n\t\t\t\t\tminorTicks: true,\r\n\t\t\t\t\tstartOnTick:false\t\t\t\t\t\r\n\t\t\t\t}];\r\n\t\t\tif (data.chart2enabled!=false){\r\n\t\t\t\tyAxis.push({\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\tformatter: function () {\r\n\t\t\t\t\t\t\treturn this.value + (data.unit2 ? ' ' + data.unit2 : '');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\talign: 'left',\r\n\t\t\t\t\t\tx: 1\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\ttext: data.xAxisLabel2\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttop: (data.chart1Height? (parseFloat(data.chart1Height) + (data.chartspacing? parseFloat(data.chartspacing) :5)) +'%':( 20 + (data.chartspacing? parseFloat(data.chartspacing) :5))+'%'),\r\n\t\t\t\t\theight: (data.chart2Height? data.chart2Height+'%':'40%'),\r\n\t\t\t\t\tlineWidth: 2,\r\n\t\t\t\t\tresize: {\r\n\t\t\t\t\t\tenabled: true\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcategories:(data.yAxis2Categories? JSON.parse (data.yAxis2Categories): undefined),\r\n\t\t\t\t\toffset: 0,\r\n\t\t\t\t\tplotLines:plotLines,\r\n\t\t\t\t\tmin: (data.yAxis2min?parseFloat(data.yAxis2min):undefined),\r\n\t\t\t\t\tmax: (data.yAxis2max?parseFloat(data.yAxis2max):undefined),\r\n\t\t\t\t\ttickAmount: (data.yAxis2tickamount?data.yAxis2tickamount:undefined),\r\n\t\t\t\t\tminorTicks: true\r\n\t\t\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t\tif (data.chart3enabled!=false){\r\n\t\t\t\tyAxis.push({\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\tformatter: function () {\r\n\t\t\t\t\t\t\treturn this.value + (data.unit3 ? ' ' + data.unit3 : '')\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\talign: 'left',\r\n\t\t\t\t\t\tx: 1\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\ttext: data.xAxisLabel3\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcategories:(data.yAxis3Categories? JSON.parse (data.yAxis3Categories): undefined),\r\n\t\t\t\t\ttop: ((data.chart1Height? parseFloat(data.chart1Height) + (data.chartspacing? parseFloat(data.chartspacing) :5):20 + (data.chartspacing? parseFloat(data.chartspacing) :5)) + (data.chart2Height? parseFloat(data.chart2Height) + (data.chartspacing? parseFloat(data.chartspacing) :5):40 + (data.chartspacing? parseFloat(data.chartspacing) :5)))+'%' ,\r\n\t\t\t\t\theight: (data.chart3Height? data.chart3Height+'%':'30%'),\r\n\t\t\t\t\toffset: 0,\r\n\t\t\t\t\tlineWidth: 2,\r\n\t\t\t\t\tmin: (data.yAxis3min?parseFloat(data.yAxis3min):undefined),\r\n\t\t\t\t\tmax: (data.yAxis3max?parseFloat(data.yAxis3max):undefined),\r\n\t\t\t\t\ttickAmount: (data.yAxis3tickamount?data.yAxis3tickamount:undefined),\r\n\t\t\t\t\tminorTicks: true\r\n\t\t\t\t});\t\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tchart = Highcharts.stockChart(divId + widgetID, {\r\n\t\t\t\tchart: {\r\n\t\t\t\t\twidth: $div.width()-2,\r\n\t\t\t\t\theight: $div.height()-2,\r\n\t\t\t\t\tzoomType: 'x',\r\n\t\t\t\t\trenderTo: divId + widgetID,\r\n\t\t\t\t\tpanning: true,\r\n\t\t\t\t\tpanKey: 'shift'\r\n\t\t\t\t},\r\n\t\t\t\ttitle: {\r\n\t\t\t\t\ttext: data.title\r\n\t\t\t\t},\r\n\t\t\t\ttime:{\r\n\t\t\t\t   useUTC: false\r\n\t\t\t\t},\r\n\t\t\t\trangeSelector: {\r\n\t\t\t\t  buttons: [{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 1,\r\n\t\t\t\t\t\ttext: '1 Tag',\r\n\t\t\t\t\t\ttitle: '1 Tag anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 3,\r\n\t\t\t\t\t\ttext: '3 Tage',\r\n\t\t\t\t\t\ttitle: '3 Tage anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 7,\r\n\t\t\t\t\t\ttext: '7 Tage',\r\n\t\t\t\t\t\ttitle: '7 Tage anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 1,\r\n\t\t\t\t\t\ttext: '1M',\r\n\t\t\t\t\t\ttitle: '1 Monat anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 3,\r\n\t\t\t\t\t\ttext: '3M',\r\n\t\t\t\t\t\ttitle: '3 Monate anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 6,\r\n\t\t\t\t\t\ttext: '6M',\r\n\t\t\t\t\t\ttitle: '6 Monate anzeigen'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tallButtonsEnabled: true,\r\n\t\t\t\t\tdropdown:'always',\r\n\t\t\t\t\theight: 10,\r\n\t\t\t\t\tselected: zoomlevel[data.zoomDefault],\r\n\t\t\t\t\tinputDateFormat:'%e. %b %Y'\r\n\t\t\t\t},\r\n\t\t\t\tnavigator: {\r\n\t\t\t\t\tadaptToUpdatedData:false,\r\n\t\t\t\t\theight: 20,\r\n\t\t\t\t\tmargin: 10,\r\n\t\t\t\t\tseries: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdata: null,\r\n\t\t\t\t\t\t\tdataGrouping: {\r\n\t\t\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\t\t\tapproximation:\"high\",\r\n\t\t\t\t\t\t\t\tunits:fbobj.highchartsSeriesUnits\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tpointInterval:10000\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t],\r\n\t\t\t\t\txAxis:{\r\n\t\t\t\t\t\tordinal: false\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tscrollbar: {\r\n\t\t\t\t\tenabled: false\r\n\t\t\t\t},\r\n\t\t\t\txAxis: {\r\n\t\t\t\t\tevents: {\r\n\t\t\t\t\t\tafterSetExtremes: afterSetExtremes,\r\n\t\t\t\t\t\tsetExtremes: setExtremes\r\n\t\t\t\t\t},\r\n\t\t\t\t\tordinal: false,\r\n\t\t\t\t\tdateTimeLabelFormats: fbobj.highchartsDateTimeLabelFormats\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tyAxis: yAxis,\r\n\r\n\t\t\t\tplotOptions: {\r\n\t\t\t\t},\r\n\t\t\t\tlegend: {\r\n\t\t\t\t\tenabled: data.showLegend,\r\n\t\t\t\t\talign: 'left',\r\n\t\t\t\t\tverticalAlign: 'top',\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 20,\r\n\t\t\t\t\tfloating: true,\r\n\t\t\t\t\titemStyle: (data.legendItemStyle?JSON.parse(data.legendItemStyle):{\"color\": \"#333333\", \"cursor\": \"pointer\", \"fontSize\": \"12px\", \"fontWeight\": \"bold\", \"textOverflow\": \"ellipsis\"}),\r\n\t\t\t\t\titemDistance : (data.legendItemDistance?parseInt(data.legendItemDistance):undefined)\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\texporting: {\r\n\t\t\t\t\tenabled: data.showMenu,\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tcredits: {\r\n\t\t\t\t   enabled: false\r\n\t\t\t\t},\r\n\t\t\t\ttooltip: {\r\n\t\t\t\t\tpointFormat: '<span style=\"color:{series.color}\">{series.name}</span>: <b>{point.y}</b><br/>',\r\n\t\t\t\t\tvalueDecimals: 2,\r\n\t\t\t\t\tsplit: true,\r\n\t\t\t\t\tfollowTouchMove:false,\t\t\t\t\t\r\n\t\t\t\t\tdateTimeLabelFormats: fbobj.highchartsDateTimeLabelFormats\t\t\t\t\r\n\t\t\t\t},\r\n\r\n\t\t\t\tseries: seriesData\r\n\t\t\t});\r\n\r\n\r\n\t\t\tfunction updateSelector(id,instance,multiplicator,start,callback) {\r\n\r\n\t\t\t\tvar option = {};\r\n\t\t\t\tvar eventDate;\r\n\t\t\t\tvar eventValue;\r\n\t\t\t\toption.start=start;\r\n\t\t\t\toption.instance  = instance;\r\n\t\t\t\toption.aggregate='minmax';\r\n\t\t\t\t//option.count=2000;\r\n\t\t\t\toption.limit=300;\r\n\t\t\t\toption.timeout=6000;\r\n\t\t\t\tvis.getHistory(id, option, function (err, res) {\r\n\t\t\t\t\tif (err && Object.keys(err).length > 0) console.error('Error Object: ' + JSON.stringify(err));\r\n\t\t\t\t\tif (!err && res) {\r\n\t\t\t\t\t\tconsole.log('got History data. Count:' + res.length);\t\t\r\n\t\t\t\t\t\tfor (var i = 0; i < res.length; i++) {\r\n\t\t\t\t\t\t\teventDate=new Date (res[i].ts);\r\n\t\t\t\t\t\t\teventValue=res[i].val * multiplicator;\r\n\t\t\t\t\t\t\tconsole.log(id +' '+ new Date (res[i].ts)+ ' n ' + eventDate + ':' + res[i].val);\r\n\t\t\t\t\t\t\tif (res[i].val!=null){\r\n\t\t\t\t\t\t\t\tif (chart.navigator.series[0].data && chart.navigator.series[0].data.length>0 && chart.navigator.series[0].data [chart.navigator.series[0].data.length-1] && chart.navigator.series[0].data[chart.navigator.series[0].data.length-1].x==eventDate.getTime()){\r\n\t\t\t\t\t\t\t\t\tif (chart.navigator.series[0].data [chart.navigator.series[0].data.length-1] && chart.navigator.series[0].data[chart.navigator.series[0].data.length-1].y!= eventValue) chart.navigator.series[0].data[chart.navigator.series[0].data.length-1].update(eventValue, false, false);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tchart.navigator.series[0].addPoint ([eventDate.getTime(),eventValue], false, false, false, false); \r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} \t\r\n\t\t\t\t\t\t// free memory\r\n\t\t\t\t\t\tres = null;\r\n\t\t\t\t\t\tchart.redraw(false);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconsole.log('Finished Selector update');\r\n\t\t\t\t\tif (callback) {\r\n\t\t\t\t\t\tconsole.log('Start callback');\r\n\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t    function updateSeriesData (){\r\n\t\t\t\tconsole.log ('Start update chart');\r\n\t\t\t\tif (!chart){\r\n\t\t\t\t\tif (fbobj.updateIntervalHandler[widgetID]) {\r\n\t\t\t\t\t\twindow.clearInterval(fbobj.updateIntervalHandler[widgetID]);\r\n\t\t\t\t\t\tfbobj.updateIntervalHandler[widgetID]=null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar oldExtremes=chart.xAxis[0].getExtremes();\t\t\t\t\r\n\t\t\t\tvar oldLastX=chart.navigator.xAxis.max;\r\n\t\t\t\t\r\n\t\t\t\tvar oldLastMaxX;\r\n\t\t\t\tif (chart.navigator.series[0].points && chart.navigator.series[0].points.length>0){\r\n\t\t\t\t\toldLastMaxX=chart.navigator.series[0].points[chart.navigator.series[0].points.length-1].x;\r\n\t\t\t\t} else {\r\n\t\t\t\t\toldLastMaxX=chart.navigator.xAxis.max;\r\n\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\tconsole.log ('V2 Start UpdateSelector Axis max: ' + (new Date (oldLastX)) + ' - Data Max: ' + (new Date (oldLastMaxX)));\r\n\t\t\t\tupdateSelector(navigator.historyOID,navigator.instance,navigator.multiplicator,oldLastMaxX+1,function (){\r\n\t\t\t\t\tconsole.log ('V2 test extremes of Selector oldExtremes max: ' + (new Date (oldExtremes.max)) + ' oldmax: ' + (new Date (oldLastMaxX)) );\t\t\t\t\t\r\n\t\t\t\t\tif (chart.navigator.series[0].points.length>0 && chart.navigator.series[0].points[chart.navigator.series[0].points.length-1].x > oldLastX && oldExtremes.max > oldLastMaxX-(10*60*1000)){\r\n\t\t\t\t\t\tvar newMaxX=chart.navigator.series[0].points[chart.navigator.series[0].points.length-1].x;\r\n\t\t\t\t\t\tconsole.log ('V2 set extremes of Selector to ' + (new Date (oldExtremes.min+newMaxX-oldExtremes.max)) + ' ' + (new Date (newMaxX) ));\r\n\t\t\t\t\t\tchart.xAxis[0].setExtremes(oldExtremes.min+newMaxX-oldExtremes.max,newMaxX, true, true, { trigger: 'zoom' });\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t});\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t    function reloadSeriesData (){\r\n\t\t\t\tconsole.log ('Start reload chart');\r\n\t\t\t\tif (!chart){\r\n\t\t\t\t\tif (fbobj.reloadIntervalHandler[widgetID]) {\r\n\t\t\t\t\t\twindow.clearInterval(fbobj.reloadIntervalHandler[widgetID]);\r\n\t\t\t\t\t\tfbobj.reloadIntervalHandler[widgetID]=null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar oldExtremes=chart.xAxis[0].getExtremes();\t\t\t\t\r\n\t\t\t\tvar oldLastX=chart.navigator.xAxis.max;\r\n\t\t\t\tnavigationData=[];\r\n\t\t\t\tloadSelectorData (navigationData,navigator.historyOID,navigator.instance,null,navigator.multiplicator,'no',(data.navigatorRange? parseInt (data.navigatorRange): 3), function (){\t\t\t\t\r\n\t\t\t\t\tchart.navigator.series[0].setData (navigationData);\t\t\t\t\r\n\t\t\t\t\tvar newMaxX=chart.navigator.xAxis.max;\r\n\t\t\t\t\tchart.xAxis[0].setExtremes(oldExtremes.min+newMaxX-oldExtremes.max,newMaxX, true, true, { trigger: 'zoom' });\r\n\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\r\n\t\t\twindow.setTimeout(function (){\r\n\t\t\t\tloadSelectorData (navigationData,navigator.historyOID,navigator.instance,null,navigator.multiplicator,'no',(data.navigatorRange? parseInt (data.navigatorRange): 3), function (){\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t\t\tchart.navigator.series[0].setData (navigationData);\t\t\t\t\r\n\t\t\t\t\tchart.navigator.series[0].xAxis.min=(navigationData && navigationData.length>0?navigationData[0][0]:undefined);\r\n\t\t\t\t\tvar startDate=new Date ();\r\n\t\t\t\t\tstartDate.setUTCMilliseconds(0);\r\n\t\t\t\t\tstartDate.setUTCSeconds(0);\t\r\n\t\t\t\t\tif (data.zoomDefault==\"1d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-1);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"3d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-3);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"7d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-7);\t\t\t\t\t   \r\n\t\t\t\t\t} else if (data.zoomDefault==\"1m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-1);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"3m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-3);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"6m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-6);\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tloadSeriesData (startDate.getTime(),new Date ().getTime(),function (){\r\n\t\t\t\t\t\tif (fbobj.updateIntervalHandler[widgetID]) window.clearInterval(fbobj.updateIntervalHandler[widgetID]);\r\n\t\t\t\t\t\tif (fbobj.reloadIntervalHandler[widgetID]) window.clearInterval(fbobj.reloadIntervalHandler[widgetID]);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t//add mouse wheel support\r\n\t\t\t\t\t\tvar zoomRatio = 0;\r\n\t\t\t\t\t\tvar lastX;\r\n\t\t\t\t\t\tvar lastY;\r\n\r\n\r\n\t\t\t\t\t\t$('#'+ divId + widgetID).mousewheel(function(objEvent, intDelta) {\r\n\t\t\t\t\t\t\tif (intDelta > 0) {\r\n\t\t\t\t\t\t\t\tzoomRatio = -1 * fbobj.scrollspeed;\r\n\t\t\t\t\t\t\t\tsetZoom();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (intDelta < 0) {\r\n\t\t\t\t\t\t\t\tzoomRatio = fbobj.scrollspeed;\r\n\t\t\t\t\t\t\t\tsetZoom();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tvar setZoom = function() {\r\n\r\n\t\t\t\t\t\t\tvar xMin = chart.xAxis[0].getExtremes().dataMin;\r\n\t\t\t\t\t\t\tvar xMax = chart.xAxis[0].getExtremes().dataMax;\r\n\t\t\t\t\t\t\tvar absMin = minDate;\r\n\t\t\t\t\t\t\tvar absMax = new Date ().getTime();\r\n\t\t\t\t\t\t   \r\n\t\t\t\t\t\t\tchart.xAxis[0].setExtremes(Math.max (absMin ,xMin - zoomRatio * (xMax-xMin)), Math.min (absMax, xMax + zoomRatio * (xMax-xMin)), true, true, { trigger: 'zoom' });\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tconsole.log ('V2 chart restart update interval');\t\t\t\t\t\t\r\n\t\t\t\t\t\tfbobj.updateIntervalHandler[widgetID]=window.setInterval(function () {\r\n\t\t\t\t\t\t   updateSeriesData ();\r\n\t\t\t\t\t\t}, 30000);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconsole.log ('V2 chart data.autoreload:' + data.autoreload);\r\n\t\t\t\t\t\tif (data.autoreload>0){\r\n\t\t\t\t\t\t\tfbobj.updateIntervalHandler[widgetID]=window.setInterval(function () {\r\n\t\t\t\t\t\t\t\treloadSeriesData ();\r\n\t\t\t\t\t\t\t}, data.autoreload * 60000);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t},10);\t\r\n\t\t},\r\n\r\n\r\n\t\tcreateTimeseries3Widget: function (widgetID, view, data, style) {\r\n\t\t\tvar seriesData = [];\r\n\t\t\tvar oidList = [];\r\n\t\t\tvar targetArray = null;\r\n\t\t\tvar divId = 'chart_placeholder';\r\n\t\t\tvar chart = null;\r\n\t\t\tvar fbobj=this;\r\n\t\t\tvar loadRunning=false;\r\n\t\t\tvar loadWaiting=false;\r\n\t\t\tvar refreshRequired=false;\r\n\t\t\tvar lastEvent=null;\t\t\t\r\n\t\t\tvar zoomlevel ={\"1d\":0,\"3d\":1,\"7d\":2,\"1m\":3,\"3m\":4,\"6m\":5};\r\n\t\t\t\r\n\t\t\tconsole.log(' photovoltaikcharts: Create Timeseries3 Widget');\r\n\t\t\r\n\t\t\tvar $div = $('#' + widgetID);\r\n\t\t\t// if nothing found => wait\r\n\t\t\tif (!$div.length) {\r\n\t\t\t\treturn setTimeout(function () {\r\n\t\t\t\t\tfbobj.createTimeseries3Widget(widgetID, view, data, style);\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t\tconsole.log (\"Initialize Chart Widget #\" + widgetID );\r\n\t\t\tvar systemLang = 'en';\r\n\t\t\tif (typeof sysLang !== 'undefined') {\r\n\t\t\t\tsystemLang = sysLang || 'en';\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tvar unit=data.unit;\r\n\r\n\r\n\t\t\t\r\n\t\t\toidList =[];\r\n\t\t\tseriesData=[];\r\n\t\t\tvar j=0;\r\n\t\t\tvar i;\r\n\t\t\tvar label;\r\n\t\t\t\r\n\t\t\tfor (i=1;i<=data.seriesCount;i++){\r\n\t\t\t\tif (data['serieshistoryoid'+i] && data ['instance'+ i ]){\r\n\t\t\t\t\tlabel=data['serieslabel'+i];\t\t\t\t\r\n\t\t\t\t\toidList.push ({id:j, historyOID:data['serieshistoryoid'+i],instance:data ['instance'+ i ],multiplicator:parseFloat(data ['multiplicator'+ i ]) || 1,lastX:0 });\r\n\t\t\t\t\t\r\n\t\t\t\t\tseriesData.push ({\r\n\t\t\t\t\t\tname: label,\r\n\t\t\t\t\t\tdata: [],\r\n\t\t\t\t\t\tcolor: data['seriescolor'+i] || '#FF5A33',\r\n\t\t\t\t\t\tlineWidth: data['serieslinewidth'+i] || 1,\r\n\t\t\t\t\t\tfillOpacity: (data['seriesopacity'+i]? parseFloat(data['seriesopacity'+i])/100 : 0.3),\r\n\t\t\t\t\t\ttype: data['seriesType'+i] || 'areaspline',\r\n\t\t\t\t\t\tstep: (data['seriesstep'+i] && data['seriesstep'+i]!='no'? data['seriesstep'+i] : undefined),\r\n\t\t\t\t\t\tstacking: (data['seriesstacking'+i] && data['seriesstacking'+i]!='no'  ? data['seriesstacking'+i] : undefined),\r\n\t\t\t\t\t\tdataGrouping: {\r\n\t\t\t\t\t\t\tenabled: data['seriesgrouping'+i],\r\n\t\t\t\t\t\t\tapproximation:\"high\",\r\n\t\t\t\t\t\t\tunits:(data['seriesType'+i]!='column' ? fbobj.highchartsSeriesUnits:undefined)\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tstates: {\t\r\n\t\t\t\t\t\t\thover: {\r\n\t\t\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\t\t\tlineWidth: data['serieshoverlinewidth'+i] || 1,\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tpointInterval:10000\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t\tj++;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\r\n\t\t\tvar plotLines=[];\r\n\t\t\tif (data.target) {\r\n\t\t\t\tplotLines.push ({color:\"#33FF50\",dashStyle:\"Solid\",label:data.targetName || 'Target',value:parseFloat(data.target),width:2});\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t\tfunction loadSeriesData (start,end,callback) {\r\n\t\t\t\tconsole.log ('resize chart to ' + new Date (start) + ' - ' + new Date (end));\r\n\t\t\t\t// chart.series[0].setData(data);\r\n\t\t\t\tloadWaiting=false;\r\n\t\t\t\tif (start && end){\r\n\t\t\t\t\tloadRunning=true;\r\n\t\t\t\t\tvar virtualStart=start;\r\n\t\t\t\t\tvar virtualEnd=end;\r\n\r\n\t\t\t\t\tchart.showLoading();\r\n\t\t\t\t\twindow.setTimeout(function (){ \r\n\t\t\t\t\t\tloadSeriesRange(chart,oidList,0,data.normalizeDate,start,end,virtualStart,virtualEnd,function () {\r\n\t\t\t\t\t\t\t//chart.xAxis.min =start;\r\n\t\t\t\t\t\t\t//chart.xAxis.max=end;\r\n\t\t\t\t\t\t\tchart.redraw();\r\n\t\t\t\t\t\t\tchart.hideLoading();\r\n\t\t\t\t\t\t\tloadRunning=false;\r\n\t\t\t\t\t\t\tif (callback) callback();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},10);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tfunction addSeriesData (start,end,callback) {\r\n\t\t\t\tconsole.log ('load and add new Data for ' + new Date (start) + ' - ' + new Date (end));\r\n\t\t\t\tif (start && end){\r\n\t\t\t\t\twindow.setTimeout(function (){ \r\n\t\t\t\t\t\tloadAndAddSeriesRange(chart,oidList,0,data.normalizeDate,start,end,start,function (newMax) {\r\n\t\t\t\t\t\t\tif (callback) callback(newMax);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},10);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\t\t\t\t\r\n\t\t\t/**\r\n\t\t\t * Load new data depending on the selected min and max\r\n\t\t\t */\r\n\t\t\tif (fbobj.delayedRefreshHandler[widgetID]) window.clearInterval(fbobj.delayedRefreshHandler[widgetID]);\t\t\t\t\t\t\r\n\t\t\tfbobj.delayedRefreshHandler[widgetID]=window.setInterval( function () {\r\n\t\t\t\tif (loadRunning==false && refreshRequired==true) {\r\n   \t\t\t\t   refreshRequired=false;\r\n  \t\t\t\t   console.log ('Process event ' + new Date (lastEvent.min) + ' - ' + new Date (lastEvent.max));\t\t\t\t   \r\n\t\t\t\t   loadSeriesData (lastEvent.min,lastEvent.max);\r\n\t\t\t\t   \r\n\t\t\t\t} \t\r\n\t\t\t},500);\r\n\r\n\t\t\tfunction afterSetExtremes(event) {\r\n\t\t\t\tconsole.log ('afterSetExtremes event ' + new Date (event.min) + ' - ' + new Date (event.max)+ ' - ' + event.trigger);\r\n\t\t\t\tif (event.trigger!=undefined){\r\n\t\t\t\t\tif (!loadRunning) {\r\n\t\t\t\t\t\tloadSeriesData (event.min,event.max);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tlastEvent=event;\r\n\t\t\t\t\t\tconsole.log ('Save event ' + new Date (event.min) + ' - ' + new Date (event.max));\r\n\r\n\t\t\t\t\t\trefreshRequired=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tfunction setExtremes(event) {\r\n\t\t\t\tconsole.log ('setExtremes event ' + new Date (event.min) + ' - ' + new Date (event.max)+ ' - ' + event.trigger);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tif (vis.language === 'de')Highcharts.setOptions(fbobj.highchartsOptions);\r\n\t\t\tvar help= vis.states[data.serieshistoryoid1];\r\n\t\t\t\r\n\t\t\tfunction selectDate () {\r\n\t\t\t\tif (data.storeTimestampSelected) {\r\n\t\t\t\t\tchart.xAxis[0].removePlotLine('selected');\r\n\t\t\t\t\tvis.setValue(data.storeTimestampSelected,this.hoverPoint.x);\r\n\t\t\t\t\tchart.xAxis[0].addPlotLine({value: this.hoverPoint.x,color: 'red',width: 2,id: 'selected'});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfunction selectDate2 (event) {\r\n\t\t\t\tif (data.storeTimestampSelected) {\r\n\t\t\t\t\tchart.xAxis[0].removePlotLine('selected');\r\n\t\t\t\t\tvis.setValue(data.storeTimestampSelected,event.point.x);\r\n\t\t\t\t\tchart.xAxis[0].addPlotLine({value: event.point.x,color: 'red',width: 2,id: 'selected'});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tchart = new Highcharts.stockChart(divId + widgetID, {\r\n\t\t\t\tchart: {\r\n\t\t\t\t\twidth: $div.width()-2,\r\n\t\t\t\t\theight: $div.height()-2,\r\n\t\t\t\t\tzoomType: 'x',\r\n\t\t\t\t\tpanning: true,\r\n\t\t\t\t\tpanKey: 'shift',\r\n\t\t\t\t\trenderTo: divId + widgetID,\r\n\t\t\t\t\tbackgroundColor: 'rgba(255,255,255,0)',\r\n\t\t\t\t\tevents: {\r\n\t\t\t\t\t\tclick: selectDate\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\ttitle: {\r\n\t\t\t\t\ttext: data.title\r\n\t\t\t\t},\r\n\t\t\t\ttime:{\r\n\t\t\t\t   useUTC: false\r\n\t\t\t\t},\r\n\t\t\t\trangeSelector: {\r\n\t\t\t\t  enabled: false,\r\n\t\t\t\t  buttons: [{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 1,\r\n\t\t\t\t\t\ttext: '1 Tag',\r\n\t\t\t\t\t\ttitle: '1 Tag anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 3,\r\n\t\t\t\t\t\ttext: '3 Tage',\r\n\t\t\t\t\t\ttitle: '3 Tage anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'day',\r\n\t\t\t\t\t\tcount: 7,\r\n\t\t\t\t\t\ttext: '7 Tage',\r\n\t\t\t\t\t\ttitle: '7 Tage anzeigen'\r\n\t\t\t\t\t},{\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 1,\r\n\t\t\t\t\t\ttext: '1M',\r\n\t\t\t\t\t\ttitle: '1 Monat anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 3,\r\n\t\t\t\t\t\ttext: '3M',\r\n\t\t\t\t\t\ttitle: '3 Monate anzeigen'\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\ttype: 'month',\r\n\t\t\t\t\t\tcount: 6,\r\n\t\t\t\t\t\ttext: '6M',\r\n\t\t\t\t\t\ttitle: '6 Monate anzeigen'\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tallButtonsEnabled: true,\r\n\t\t\t\t\tdropdown:'always',\r\n\t\t\t\t\theight: 10,\r\n\t\t\t\t\tinputDateFormat:'%e. %b %Y'\r\n\t\t\t\t},\r\n\t\t\t\tnavigator: {\r\n\t\t\t\t\tenabled:false,\r\n\t\t\t\t\tseries: [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdata: null,\r\n\t\t\t\t\t\t\tdataGrouping: {\r\n\t\t\t\t\t\t\t\tenabled: true,\r\n\t\t\t\t\t\t\t\tapproximation:\"high\",\r\n\t\t\t\t\t\t\t\tunits:fbobj.highchartsSeriesUnits\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tpointInterval:10000\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t],\r\n\t\t\t\t\txAxis:{\r\n\t\t\t\t\t\tordinal: false\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tscrollbar: {\r\n\t\t\t\t\tenabled: false\r\n\t\t\t\t},\r\n\t\t\t\txAxis: {\r\n\t\t\t\t\tevents: {\r\n\t\t\t\t\t\tafterSetExtremes: afterSetExtremes,\r\n\t\t\t\t\t\tsetExtremes: setExtremes,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tordinal: false,\r\n\t\t\t\t\tdateTimeLabelFormats: fbobj.highchartsDateTimeLabelFormats,\r\n\t\t\t\t\tcrosshair: data.showCrosshairX\r\n\t\t\t\t\t\r\n\t\t\t\t\t//overscroll: 10000\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tyAxis: [{\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\tformatter: function () {\r\n\t\t\t\t\t\t\treturn this.value + (unit ? ' ' + unit : '');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\talign: 'left',\r\n\t\t\t\t\t\tx: 1,\r\n\t\t\t\t\t\tcrosshair: data.showCrosshairY\r\n\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlineWidth: 2,\r\n\t\t\t\t\toffset: 0,\r\n\t\t\t\t\tcategories:(data.yAxis1Categories? JSON.parse (data.yAxis1Categories): undefined),\r\n\t\t\t\t\tmin: (data.yAxis1min?parseFloat(data.yAxis1min):undefined),\r\n\t\t\t\t\tmax: (data.yAxis1max?parseFloat(data.yAxis1max):undefined),\r\n\t\t\t\t\ttickAmount: (data.yAxis1tickamount?data.yAxis1tickamount:undefined),\r\n\t\t\t\t\tminorTicks: true,\r\n\t\t\t\t\tstartOnTick:false,\r\n\t\t\t\t\tvisible: data.showYAxis\r\n\t\t\r\n\t\t\t\t}\r\n\t\t\t\t],\r\n\r\n\t\t\t\tplotOptions: {\r\n\t\t\t\t\tseries: {\r\n\t\t\t\t\t\tevents: {\r\n\t\t\t\t\t\t\tclick: selectDate2\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n/*\r\n\t\t\t\t\t\tallowPointSelect: (data.storeTimestampSelected? true: false),\r\n\t\t\t\t\t\tpoint: {\r\n\t\t\t\t\t\t\tevents: {\r\n\t\t\t\t\t\t\t\tselect: function () {\r\n\t\t\t\t\t\t\t\t\tif (data.storeTimestampSelected && this.x) {\r\n\t\t\t\t\t\t\t\t\t\tvis.states[data.storeTimestampSelected + '.val']=this.x;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t*/\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tlegend: {\r\n\t\t\t\t\tenabled: data.showLegend,\r\n\t\t\t\t\talign: 'left',\r\n\t\t\t\t\tverticalAlign: 'top',\r\n\t\t\t\t\tx: 0,\r\n\t\t\t\t\ty: 2,\r\n\t\t\t\t\tfloating: true           \r\n\t\t\t\t},\r\n\t\t\t\texporting: {\r\n\t\t\t\t\tenabled: data.showMenu,\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\t\t\t\tcredits: {\r\n\t\t\t\t   enabled: false\r\n\t\t\t\t},\r\n\t\t\t\ttooltip: {\r\n\t\t\t\t\tpointFormat: '<span style=\"color:{series.color}\">{series.name}</span>: <b>{point.y}</b><br/>',\r\n\t\t\t\t\tvalueDecimals: 2,\r\n\t\t\t\t\tsplit: true,\r\n\t\t\t\t\tfollowTouchMove:false,\t\t\t\t\t\r\n\t\t\t\t\tdateTimeLabelFormats: fbobj.highchartsDateTimeLabelFormats\t\t\t\t\t\r\n\t\t\t\t},\r\n\r\n\t\t\t\tseries: seriesData\r\n\t\t\t});\r\n\r\n\r\n\r\n\t\t    function updateSeriesData (){\r\n\t\t\t\tconsole.log ('Start update chart');\r\n\t\t\t\tif (!chart){\r\n\t\t\t\t\tif (fbobj.updateIntervalHandler[widgetID]) {\r\n\t\t\t\t\t\twindow.clearInterval(fbobj.updateIntervalHandler[widgetID]);\r\n\t\t\t\t\t\tfbobj.updateIntervalHandler[widgetID]=null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar oldExtremes=chart.xAxis[0].getExtremes();\t\t\t\t\r\n\t\t\t\tif (loadRunning==false && (new Date()).getTime()-(10*60*1000)< oldExtremes.max){\r\n\t\t\t\t\t\r\n\t\t\t\t\taddSeriesData (oldExtremes.dataMax,(new Date()).getTime(),function (newMax){\r\n\t\t\t\t\t\t\t\t \t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\tchart.xAxis[0].setExtremes(oldExtremes.dataMin + newMax - oldExtremes.dataMax ,newMax);\r\n\t\t\t\t\t\tconsole.log ('Updated chart data to ' + new Date (oldExtremes.dataMin + newMax - oldExtremes.dataMax) + ' - ' + new Date (newMax));\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\t$(window).resize(function() {\r\n\t\t\t  console.log( \"Resize Chart \" + divId + widgetID);\r\n\t\t\t  chart.setSize(null, null);\r\n\t\t\t});\r\n\r\n\r\n\t\t\twindow.setTimeout(function (){\t\t\t\t\r\n\t\t\t\tvar startDate=new Date ();\r\n\t\t\t\tstartDate.setUTCMilliseconds(0);\r\n\t\t\t\tstartDate.setUTCSeconds(0);\t\r\n\t\t\t\tif (data.zoomoid && vis.states[data.zoomoid + '.val']) {\r\n\t\t\t\t\tconsole.log ('use range info from zoomid:' + vis.states[data.zoomoid + '.val'] + ' type ' + typeof vis.states[data.zoomoid + '.val']);\r\n\t\t\t\t\tstartDate=new Date ((new Date ()).getTime() - (vis.states[data.zoomoid + '.val']*1000));\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (data.zoomDefault==\"1d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-1);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"3d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-3);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"7d\"){\r\n\t\t\t\t\t   startDate.setDate (startDate.getDate()-7);\t\t\t\t\t   \r\n\t\t\t\t\t} else if (data.zoomDefault==\"1m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-1);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"3m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-3);\r\n\t\t\t\t\t} else if (data.zoomDefault==\"6m\"){\r\n\t\t\t\t\t\tstartDate.setUTCMinutes(0);\r\n\t\t\t\t\t\tstartDate.setUTCHours(0);\t\t\r\n\t\t\t\t\t\tstartDate.setUTCMonth (startDate.getMonth()-6);\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tloadSeriesData (startDate.getTime(),new Date ().getTime(),function (){\r\n\t\t\t\t\tchart.xAxis[0].allowZoomOutside = true;\r\n\t\t\t\t\r\n\t\t\t\t\t//add mouse wheel support\r\n\t\t\t\t\tvar zoomRatio = 0;\r\n\t\t\t\t\tvar lastX;\r\n\t\t\t\t\tvar lastY;\r\n\r\n\r\n\t\t\t\t\t$('#'+ divId + widgetID).mousewheel(function(objEvent, intDelta) {\r\n\t\t\t\t\t\tif (intDelta > 0) {\r\n\t\t\t\t\t\t\tzoomRatio = -1 * fbobj.scrollspeed;\r\n\t\t\t\t\t\t\tsetZoom();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse if (intDelta < 0) {\r\n\t\t\t\t\t\t\tzoomRatio = fbobj.scrollspeed;\r\n\t\t\t\t\t\t\tsetZoom();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tvar setZoom = function() {\r\n\r\n\t\t\t\t\t\tvar xMin = chart.xAxis[0].getExtremes().dataMin;\r\n\t\t\t\t\t\tvar xMax = chart.xAxis[0].getExtremes().dataMax;\r\n\t\t\t\t\t\tvar absMin = minDate;\r\n\t\t\t\t\t\tvar absMax = new Date ().getTime();\r\n\t\t\t\t\t   \r\n\t\t\t\t\t\tchart.xAxis[0].setExtremes(Math.max (absMin ,xMin - zoomRatio * (xMax-xMin)), Math.min (absMax, xMax + zoomRatio * (xMax-xMin)), true, true, { trigger: 'zoom' });\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (data.storeTimestampSelected && chart.series && chart.series [0] && chart.series [0].points.length>0) {\r\n\t\t\t\t\t\tvis.setValue(data.storeTimestampSelected,chart.series [0].points[chart.series [0].points.length-1].x);\r\n\t\t\t\t\t\tchart.xAxis[0].addPlotLine({value: chart.series [0].points[chart.series [0].points.length-1].x,color: 'red',width: 2,id: 'selected'});\r\n\t\t\t\t\t}\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (fbobj.updateIntervalHandler[widgetID]) window.clearInterval(fbobj.updateIntervalHandler[widgetID]);\r\n\t\t\t\t\tfbobj.updateIntervalHandler[widgetID]=window.setInterval(function () {\r\n\t\t\t\t\t   updateSeriesData ();\r\n\t\t\t\t\t}, 30000);\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction stepForward () {\r\n\t\t\t\t\t\tvar selected = findSelected ();\r\n\t\t\t\t\t\tif (selected+ parseInt(data.playstep  ||  1) <chart.series[0].points.length) {\r\n\t\t\t\t\t\t\tselected=selected + parseInt(data.playstep || 1);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tselected=0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tchart.xAxis[0].removePlotLine('selected');\r\n\t\t\t\t\t\tvis.setValue(data.storeTimestampSelected,chart.series[0].points[selected].x);\r\n\t\t\t\t\t\tchart.xAxis[0].addPlotLine({value: chart.series[0].points[selected].x,color: 'red',width: 2,id: 'selected'});\r\n\t\t\t\t\t\tif (fbobj.playHandler[widgetID]) window.clearInterval(fbobj.playHandler[widgetID]);\r\n\t\t\t\t\t\tif (vis.states [data.playid + '.val']==true) {\r\n\t\t\t\t\t\t\tfbobj.playHandler[widgetID]=window.setTimeout (function () {\r\n\t\t\t\t\t\t\t\tstepForward ();\r\n\t\t\t\t\t\t\t},parseInt(data.playspeed  ||  3) *1000);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction stepBackward () {\r\n\t\t\t\t\t\tvar selected = findSelected ();\r\n\t\t\t\t\t\tif (selected>parseInt(data.playstep  ||  1)) {\r\n\t\t\t\t\t\t\tselected=selected-parseInt(data.playstep  ||  1)\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tselected=chart.series[0].points.length-parseInt(data.playstep  ||  1);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tchart.xAxis[0].removePlotLine('selected');\r\n\t\t\t\t\t\tvis.setValue(data.storeTimestampSelected,chart.series[0].points[selected].x);\r\n\t\t\t\t\t\tchart.xAxis[0].addPlotLine({value: chart.series[0].points[selected].x,color: 'red',width: 2,id: 'selected'});\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction onStepForward (e, newVal, oldVal){\r\n\t\t\t\t\t\tif (newVal==true){\r\n\t\t\t\t\t\t\tvis.setValue (data.stepforwardid,false);\r\n\t\t\t\t\t\t\tstepForward ();\r\n\t\t\t\t\t\t}\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction onStepBackward (e, newVal, oldVal){\r\n\t\t\t\t\t\tif (newVal==true){\r\n\t\t\t\t\t\t\tvis.setValue (data.stepbackid,false);\r\n\t\t\t\t\t\t\tstepBackward ();\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction onPlay (e, newVal, oldVal){\r\n\t\t\t\t\t\tif (newVal==true){\r\n\t\t\t\t\t\t\t\tstepForward ();\r\n\t\t\t\t\t\t\t\t//vis.setValue (data.playid,false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction findSelected (){\r\n\t\t\t\t\t\tvar value,i;\r\n\t\t\t\t\t\tif (chart.xAxis[0].plotLinesAndBands.length>0){\r\n\t\t\t\t\t\t\tfor (i=0;i<chart.xAxis[0].plotLinesAndBands.length;i++){\r\n\t\t\t\t\t\t\t\tif (chart.xAxis[0].plotLinesAndBands[i].id=='selected'){\r\n\t\t\t\t\t\t\t\t\tvalue=chart.xAxis[0].plotLinesAndBands[i].options.value;\r\n\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!value) return 0;\r\n\t\t\t\t\t\t\tfor (i=0;i<chart.series[0].points.length;i++){\r\n\t\t\t\t\t\t\t\tif (chart.series[0].points[i].x==value){\r\n\t\t\t\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 0; \r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (data.playid && data.storeTimestampSelected) {\r\n\t\t\t\t\t\tconsole.log ('register on changes for ' + data.playid);\r\n\t\t\t\t\t\tvis.states.bind(data.playid + '.val', onPlay);\r\n\t\t\t\t\t\t$div.data('bound', [data.playid + '.val']);\r\n\t\t\t\t\t\t$div.data('bindHandler', onPlay);\r\n\t\t\t\t\t}\t\t\t\r\n\r\n\t\t\t\t\tif (data.stepbackid && data.storeTimestampSelected) {\r\n\t\t\t\t\t\tconsole.log ('register on changes for ' + data.stepbackid);\r\n\t\t\t\t\t\tvis.states.bind(data.stepbackid + '.val', onStepBackward);\r\n\t\t\t\t\t\t$div.data('bound', [data.stepbackid + '.val']);\r\n\t\t\t\t\t\t$div.data('bindHandler', onStepBackward);\r\n\t\t\t\t\t}\t\t\t\r\n\r\n\t\t\t\t\tif (data.stepbackid && data.storeTimestampSelected) {\r\n\t\t\t\t\t\tconsole.log ('register on changes for ' + data.stepforwardid);\r\n\t\t\t\t\t\tvis.states.bind(data.stepforwardid + '.val', onStepForward);\r\n\t\t\t\t\t\t$div.data('bound', [data.stepforwardid + '.val']);\r\n\t\t\t\t\t\t$div.data('bindHandler', onStepForward);\r\n\t\t\t\t\t}\t\r\n\r\n\t\t\t\t\tif (vis.editMode!=true && data.storeTimestampSelected && vis.states [data.playid + '.val']==true) fbobj.playHandler[widgetID]=window.setTimeout (function () {\r\n\t\t\t\t\t\tstepForward ();\r\n\t\t\t\t\t},parseInt(data.playspeed  ||  3) *1000);\r\n\t\t\t\t\t\r\n\t\t\t\t\tchart.setSize(null, null);\t\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t\t\r\n\t\t\t\t\r\n\t\t\t},10);\t\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tfunction onChangeZoom(e, newVal, oldVal) {\r\n\t\t\t\tconsole.log ('Change zoom');\t\t\t\r\n\t\t\t\tif (!chart || newVal==oldVal) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (data.zoomoid && vis.states[data.zoomoid + '.val']) {\r\n\t\t\t\t\tvar currentExtremes=chart.xAxis[0].getExtremes();\t\t\t\t\t\r\n\t\t\t\t\tvar startDate=new Date ((new Date (currentExtremes.dataMax)).getTime() - (newVal*1000));\r\n\t\t\t\t\tchart.xAxis[0].setExtremes(startDate.getTime(), currentExtremes.dataMax, true, true, { trigger: 'zoom' });\t\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tif (data.zoomoid) {\r\n\t\t\t\tconsole.log ('register on changes for ' + data.zoomoid);\r\n\t\t\t\tvis.states.bind(data.zoomoid + '.val', onChangeZoom);\r\n\t\t\t\t$div.data('bound', [data.zoomoid + '.val']);\r\n\t\t\t\t$div.data('bindHandler', onChangeZoom);\r\n\t\t\t}\t\r\n\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\tcreatePhotovoltaikModuleWidget: function (widgetID, view, data, style) {\r\n\t\t\tvar fbobj=this;\r\n\t\t\tvar cache=[];\r\n\t\t\tvar historyLoading=false;\r\n\t\t\tvar $div = $('#' + widgetID);\r\n\t\t\t// if nothing found => wait\r\n\t\t\tif (!$div.length) {\r\n\t\t\t\treturn setTimeout(function () {\r\n\t\t\t\t\tfbobj.createPhotovoltaikModuleWidget(widgetID, view, data, style);\r\n\t\t\t\t}, 100);\r\n\t\t\t};\r\n\r\n\r\n\t\t\tfunction getValue (id,instance,multiplicator,ts,callback){\r\n\t\t\t   var option = {};\r\n\t\t\t\tif (historyLoading) return callback ();\r\n\t\t\t\thistoryLoading= true;\r\n\t\t\t\toption.start=ts-1;\r\n\t\t\t\toption.end=ts+(2*360000);\r\n\t\t\t\toption.instance  = instance;\r\n\t\t\t\toption.aggregate='none';\r\n\t\t\t\toption.count=1;\r\n\t\t\t\toption.timeout=5000;\r\n\t\t\t\tvis.getHistory(id, option, function (err, res) {\r\n\t\t\t\t\thistoryLoading= false;\t\t\t\r\n\t\t\t\t\tif (err && Object.keys(err).length > 0) {\r\n\t\t\t\t\t\tconsole.error('Error Object: ' + err);\r\n\t\t\t\t\t\tcallback ();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!err && res) {\r\n\t\t\t\t\t\tif (res.length>0) {\r\n\t\t\t\t\t\t\tvar now=new Date ().getTime();\r\n\t\t\t\t\t\t\tfor (var i=0;i<res.length;i++) {\r\n\t\t\t\t\t\t\t\tvar obj={val: res[i].val, cacheDate:now};\r\n\t\t\t\t\t\t\t\tcache [res[i].ts]=obj;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcallback ((res[0].val || 0) * multiplicator);\r\n\t\t\t\t\t\t} \t\r\n\t\t\t\t\t\t// free memory\r\n\t\t\t\t\t\tres = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\t\r\n\t\t\t};\r\n\r\n\t\t\tfunction getColor (energyValue){\r\n\t\t\t\tvar vgValue=energyValue/(data.modulePower || 355);\r\n\t\t\t\tif (vgValue > 0.9)\r\n\t\t\t\t\treturn '#F4FD02'\r\n\t\t\t\telse if (vgValue > 0.8)\r\n\t\t\t\t\treturn '#12FD02'\r\n\t\t\t\telse if (vgValue > 0.6)\r\n\t\t\t\t\treturn '#02FDAD'\r\n\t\t\t\telse if (vgValue > 0.4)\r\n\t\t\t\t\treturn '#02D4FD'\r\n\t\t\t\telse if (vgValue > 0.2)\r\n\t\t\t\t\treturn '#029BFD'\r\n\t\t\t\telse if (vgValue > 0.1)\r\n\t\t\t\t\treturn '#0208FD'\r\n\t\t\t\telse \r\n\t\t\t\t\treturn '#0238FD';\r\n\t\t\t\t\t\r\n\t\t\t}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\t\t\tvar svg=$(\"#photovoltaikmodule\"+widgetID).find(\"svg:first\");\r\n\r\n\t\t\t$(\"#label\", svg).text (data.serieslabel);\r\n\t\t\t\r\n\t\t\tif (data.serieshistoryoid && data.instance && data.timestampid && vis.states[data.timestampid + '.val']) {\r\n\t\t\t\tgetValue(data.serieshistoryoid,data.instance,parseFloat (data.multiplicator || 1),vis.states[data.timestampid + '.val'],function (energyValue) {\r\n\t\t\t\t\tif (energyValue) {\r\n\t\t\t\t\t\t$(\"#power\", svg).text (energyValue.toLocaleString(undefined,{ minimumFractionDigits: 2 }));\r\n\t\t\t\t\t\t$(\"#modulecolor\", svg).attr(\"fill\",getColor(energyValue));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#power\", svg).text ('--');\r\n\t\t\t\t\t\t$(\"#modulecolor\", svg).attr(\"fill\",\"#007fff\");\r\n\t\t\t\t\t};\t\t\t\t\t\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\t$(\"#power\", svg).text ('--');\r\n\t\t\t\t$(\"#modulecolor\", svg).attr(\"fill\",\"#007fff\");\r\n\t\t\t\t\r\n\t\t\t};\r\n\t\t\r\n\r\n\t\t\t\r\n\t\t\t// subscribe on updates of value\r\n\t\t\t\r\n\t\t\t\r\n\t\t\tfunction onChangeValue (e, newVal, oldVal) {\t\t\r\n\t\t\t\tconsole.log ('Changed value for widget ' + widgetID + ' value ' + new Date (newVal));\r\n\t\t\t\t//if (data.serieshistoryoid && data.instance && data.timestampid) {\r\n\t\t\t\tif ((e != undefined) && (newVal != oldVal)) {\r\n\t\t\t\t\tif (cache[newVal] != undefined && cache[newVal].cacheDate > (new Date ().getTime()-360000)) {\r\n\t\t\t\t\t\tif (cache[newVal].val) {\r\n\t\t\t\t\t\t\t$(\"#power\", svg).text (cache[newVal].val.toLocaleString(undefined,{ minimumFractionDigits: 2 }));\r\n\t\t\t\t\t\t\t$(\"#modulecolor\", svg).attr(\"fill\",getColor(cache[newVal].val));\r\n\r\n\t\t\t\t\t\t} else if (cache[newVal].val===0){\r\n\t\t\t\t\t\t\t$(\"#power\", svg).text ('--');\r\n\t\t\t\t\t\t\t$(\"#modulecolor\", svg).attr(\"fill\",\"#007fff\");\r\n\t\t\t\t\t\t};\t\t\t\t\t\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\twindow.setTimeout (function () {\r\n\t\t\t\t\t\t\tgetValue(data.serieshistoryoid,data.instance,parseFloat (data.multiplicator || 1),newVal,function (energyValue) {\r\n\t\t\t\t\t\t\t\tif (energyValue) {\r\n\t\t\t\t\t\t\t\t\t$(\"#power\", svg).text (energyValue.toLocaleString(undefined,{ minimumFractionDigits: 2 }));\r\n\t\t\t\t\t\t\t\t\t$(\"#modulecolor\", svg).attr(\"fill\",getColor(energyValue));\r\n\r\n\t\t\t\t\t\t\t\t} else if (energyValue===0){\r\n\t\t\t\t\t\t\t\t\t$(\"#power\", svg).text ('--');\r\n\t\t\t\t\t\t\t\t\t$(\"#modulecolor\", svg).attr(\"fill\",\"#007fff\");\r\n\t\t\t\t\t\t\t\t};\t\t\t\t\t\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},10);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\t\t\t\t\t\t\r\n\t\t\t}\r\n\t\t\t\t\t\r\n\r\n\t\t\tif (data.timestampid) {\r\n\t\t\t\tconsole.log ('register on changes for ' + data.timestampid);\r\n\t\t\t\tvis.states.bind(data.timestampid + '.val', onChangeValue);\r\n\t\t\t\t$div.data('bound', [data.timestampid + '.val']);\r\n\t\t\t\t$div.data('bindHandler', onChangeValue);\r\n\t\t\t}\t\t\t\r\n\t\t},\r\n\t\t\r\n\t\tcreateGaugeWidget: function (widgetID, view, data, style) {\r\n\t\t\tvar divId = 'chart_placeholder';\r\n\t\t\tvar chart = null;\r\n\r\n\t\t\tvar fbobj=this;\r\n\t\t\tconsole.log(' vis-photovoltaikcharts: Create Gauge Widget');\r\n\t\t\r\n\t\t\tvar $div = $('#' + widgetID);\r\n\t\t\t// if nothing found => wait\r\n\t\t\tif (!$div.length) {\r\n\t\t\t\treturn setTimeout(function () {\r\n\t\t\t\t\tfbobj.createGaugeWidget(widgetID, view, data, style);\r\n\t\t\t\t}, 100);\r\n\t\t\t}\r\n\t\t\tconsole.log (\"Initialize Chart Widget #\" + widgetID );\r\n\t\t\tvar systemLang = 'en';\r\n\t\t\tif (typeof sysLang !== 'undefined') {\r\n\t\t\t\tsystemLang = sysLang || 'en';\r\n\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\r\n\t\t\tvar gaugeOptions = {\r\n\t\t\t\tchart: {\r\n\t\t\t\t\ttype: 'solidgauge'\r\n\t\t\t\t},\r\n\r\n\t\t\t\ttitle: undefined,\r\n\r\n\t\t\t\tpane: {\r\n\t\t\t\t\tcenter: [(data.panCenterX?data.panCenterX + '%':'50%'), (data.panCenterY?data.panCenterY + '%':'50%')],\r\n\t\t\t\t\tsize: '160%',\r\n\t\t\t\t\tstartAngle: (data.startAngel?parseInt (data.startAngel):-90),\r\n\t\t\t\t\tendAngle: (data.stopAngel?parseInt (data.stopAngel):90),\r\n\t\t\t\t\tbackground: {\r\n\t\t\t\t\t\tbackgroundColor: { linearGradient: { x1: 0, y1: 0, x2: 0, y2: 1 }, stops: [[0, data.paneBackgroundColor1 || '#ffffff'], [1, data.paneBackgroundColor2 || '#eee']] },\r\n\t\t\t\t\t\tborderColor: data.borderColor,\r\n\t\t\t\t\t\tinnerRadius: (data.innerRadius?data.innerRadius + '%':'60%'),\r\n\t\t\t\t\t\touterRadius: (data.outerRadius?data.outerRadius + '%':'100%'),\r\n\t\t\t\t\t\tshape: data.shape || 'arc'\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\r\n\t\t\t\texporting: {\r\n\t\t\t\t\tenabled: false\r\n\t\t\t\t},\r\n\r\n\t\t\t\ttooltip: {\r\n\t\t\t\t\tenabled: false\r\n\t\t\t\t},\r\n\r\n\t\t\t\t// the value axis\r\n\t\t\t\tyAxis: {\r\n\t\t\t\t\tstops: [],\r\n\t\t\t\t\tlineWidth: data.lineWidth,\r\n\t\t\t\t\ttickWidth: data.tickWidth,\r\n\t\t\t\t\tminorTickInterval: parseInt (data.minorTickInterval),\r\n\t\t\t\t\ttickAmount: parseInt (data.tickAmount),\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\ty: parseInt (data.titlePositionY) || -70\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlabels: {\r\n\t\t\t\t\t\ty: parseInt (data.labelsPositionY) || 16\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmin: parseInt(data.min) || 0,\r\n\t\t\t\t\tmax: parseInt(data.max) || 100,\r\n\t\t\t\t\ttitle: {\r\n\t\t\t\t\t\ttext: data.title\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tplotOptions: {\r\n\t\t\t\t\tsolidgauge: {\r\n\t\t\t\t\t\tdataLabels: {\r\n\t\t\t\t\t\t\ty: parseInt (data.dataLabelsPositionY) || 5,\r\n\t\t\t\t\t\t\tborderWidth: parseInt (data.dataLabelsBorderWidth) || 0,\r\n\t\t\t\t\t\t\tuseHTML: true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\t\r\n\r\n\t\t\t\tcredits: {\r\n\t\t\t\t\tenabled: false\r\n\t\t\t\t},\r\n\r\n\t\t\t\tseries: [{\r\n\t\t\t\t\tname: data.title,\r\n\t\t\t\t\tdata: [vis.states[data.oid + '.val']* (parseFloat (data.multiplicator) || 1)],\r\n\t\t\t\t\tdataLabels: {\r\n\t\t\t\t\t\tformat:\r\n\t\t\t\t\t\t\t'<div style=\"text-align:center\">' +\r\n\t\t\t\t\t\t\t'<span style=\"font-size:' + (data.fontsizevalue || '25px') +'\">{y}</span><br/>' +\r\n\t\t\t\t\t\t\t(data.valuesuffix?'<span style=\"font-size:' + (data.fontsizesuffix || '12px') +';opacity:0.4\">'+data.valuesuffix+'</span>' :'')+\r\n\t\t\t\t\t\t\t'</div>'\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttooltip: {\r\n\t\t\t\t\t\tvalueSuffix: data.valuesuffix\r\n\t\t\t\t\t}\r\n\t\t\t\t}]\r\n\t\t\t\t\r\n\t\t\t};\r\n\t\t\t\r\n            if (data.stopCount>0){\r\n\t\t\t\tvar stop;\r\n\t\t\t\tfor (var i=0;i<data.stopCount;i++){\r\n\t\t\t\t\tif (data['stopposition'+(i+1)]){\r\n\t\t\t\t\t\tstop=[data['stopposition'+(i+1)]/100,data['stopcolor'+(i+1)]];\r\n\t\t\t\t\t\tgaugeOptions.yAxis.stops.push(stop);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tvar chart = Highcharts.chart(divId + widgetID, gaugeOptions);\r\n\t\t\t\t\r\n\r\n\t\t\t\r\n\t\t\tfunction onChangeSeries (e, newVal, oldVal) {\r\n\t\t\t\tif (!chart || newVal==oldVal) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tchart.series[0].points[0].update(newVal * (parseFloat (data.multiplicator) || 1));\r\n\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\tif (data.oid!=undefined) {\r\n\t\t\t\tconsole.log ('register on changes for ' + data.oid);\r\n\t\t\t\tvis.states.bind(data.oid + '.val', onChangeSeries);\r\n\t\t\t\t$div.data('bound', [data.oid + '.val']);\r\n\t\t\t\t$div.data('bindHandler', onChangeSeries);\r\n\t\t\t}\t\t\t\t\t\t\r\n\t\t}\r\n\r\n\t};\r\n\t\r\n\r\n\tvis.binds.photovoltaikcharts.showVersion();\t\t"]}